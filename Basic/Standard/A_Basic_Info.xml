<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="A_Basic_Info" script:language="StarBasic">&apos;*************************************
&apos;Add Row Functionality
&apos;A_Basic_Info - Part1
&apos;Case : Self
&apos;*************************************
Sub addRow_A_Basic_Info_SecBIIList()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;RentPaid.RentListS&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(aPinOfLandLordList1_Listener,aPinOfLandLordList1)
    call removeKRAListners(aCountyList1_Listener,aCountyList1)
    call removeKRAListners(aDistrictList1_Listener,aDistrictList1)
    call removeKRAListners(aBusinessLocalityList1_Listener,aBusinessLocalityList1)
    call removeKRAListners(aTownList1_Listener,aTownList1)
    call removeKRAListners(aDateFromList1_Listener,aDateFromList1)
    call removeKRAListners(aDateToList1_Listener,aDateToList1)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;A&quot;,&quot;aPinOfLandLordList1_Listener_&quot;,aPinOfLandLordList1_Listener,aPinOfLandLordList1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;G&quot;,&quot;aCountyList1_Listener_&quot;,aCountyList1_Listener,aCountyList1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;H&quot;,&quot;aDistrictList1_Listener_&quot;,aDistrictList1_Listener,aDistrictList1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;I&quot;,&quot;aBusinessLocalityList1_Listener_&quot;,aBusinessLocalityList1_Listener,aBusinessLocalityList1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;L&quot;,&quot;aTownList1_Listener_&quot;,aTownList1_Listener,aTownList1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;N&quot;,&quot;aDateFromList1_Listener_&quot;,aDateFromList1_Listener,aDateFromList1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;O&quot;,&quot;aDateToList1_Listener_&quot;,aDateToList1_Listener,aDateToList1)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;A_Basic_Info - Part2
&apos;Case : Self
&apos;*************************************
Sub addRow_A_Basic_Info_SecHIList()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;RentalIncome.ListS&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(aPinOfTenantList2_Listener,aPinOfTenantList2)
    call removeKRAListners(aCountyList2_Listener,aCountyList2)
    call removeKRAListners(aDistrictList2_Listener,aDistrictList2)
    call removeKRAListners(aBusinessLocalityList2_Listener,aBusinessLocalityList2)
    call removeKRAListners(aTownList2_Listener,aTownList2)
    call removeKRAListners(aDateFromList2_Listener,aDateFromList2)
    call removeKRAListners(aDateToList2_Listener,aDateToList2)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;A&quot;,&quot;aPinOfTenantList2_Listener_&quot;,aPinOfTenantList2_Listener,aPinOfTenantList2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;G&quot;,&quot;aCountyList2_Listener_&quot;,aCountyList2_Listener,aCountyList2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;H&quot;,&quot;aDistrictList2_Listener_&quot;,aDistrictList2_Listener,aDistrictList2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;I&quot;,&quot;aBusinessLocalityList2_Listener_&quot;,aBusinessLocalityList2_Listener,aBusinessLocalityList2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;L&quot;,&quot;aTownList2_Listener_&quot;,aTownList2_Listener,aTownList2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;N&quot;,&quot;aDateFromList2_Listener_&quot;,aDateFromList2_Listener,aDateFromList2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;O&quot;,&quot;aDateToList2_Listener_&quot;,aDateToList2_Listener,aDateToList2)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;A_Basic_Info - Part1
&apos;Case : Wife
&apos;*************************************
Sub addRow_A_Basic_Info_SecBIIListWife()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;RentPaid.RentListW&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(aPinOfLandLordList1_Listener,aPinOfLandLordList1)
    call removeKRAListners(aCountyList1_Listener,aCountyList1)
    call removeKRAListners(aDistrictList1_Listener,aDistrictList1)
    call removeKRAListners(aBusinessLocalityList1_Listener,aBusinessLocalityList1)
    call removeKRAListners(aTownList1_Listener,aTownList1)
    call removeKRAListners(aDateFromList1_Listener,aDateFromList1)
    call removeKRAListners(aDateToList1_Listener,aDateToList1)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;A&quot;,&quot;aPinOfLandLordListW1_Listener_&quot;,aPinOfLandLordListW1_Listener,aPinOfLandLordListW1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;G&quot;,&quot;aCountyListW1_Listener_&quot;,aCountyListW1_Listener,aCountyListW1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;H&quot;,&quot;aDistrictListW1_Listener_&quot;,aDistrictListW1_Listener,aDistrictListW1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;I&quot;,&quot;aBusinessLocalityListW1_Listener_&quot;,aBusinessLocalityListW1_Listener,aBusinessLocalityListW1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;L&quot;,&quot;aTownListW1_Listener_&quot;,aTownListW1_Listener,aTownListW1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;N&quot;,&quot;aDateFromListW1_Listener_&quot;,aDateFromListW1_Listener,aDateFromListW1)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;O&quot;,&quot;aDateToListW1_Listener_&quot;,aDateToListW1_Listener,aDateToListW1)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;A_Basic_Info - Part2
&apos;Case : Wife
&apos;*************************************
Sub addRow_A_Basic_Info_SecHIListWife()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;RentalIncome.ListW&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(aPinOfTenantList2_Listener,aPinOfTenantList2)
    call removeKRAListners(aCountyList2_Listener,aCountyList2)
    call removeKRAListners(aDistrictList2_Listener,aDistrictList2)
    call removeKRAListners(aBusinessLocalityList2_Listener,aBusinessLocalityList2)
    call removeKRAListners(aTownList2_Listener,aTownList2)
    call removeKRAListners(aDateFromList2_Listener,aDateFromList2)
    call removeKRAListners(aDateToList2_Listener,aDateToList2)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;A&quot;,&quot;aPinOfTenantListW2_Listener_&quot;,aPinOfTenantListW2_Listener,aPinOfTenantListW2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;G&quot;,&quot;aCountyListW2_Listener_&quot;,aCountyListW2_Listener,aCountyListW2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;H&quot;,&quot;aDistrictListW2_Listener_&quot;,aDistrictListW2_Listener,aDistrictListW2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;I&quot;,&quot;aBusinessLocalityListW2_Listener_&quot;,aBusinessLocalityListW2_Listener,aBusinessLocalityListW2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;L&quot;,&quot;aTownListW2_Listener_&quot;,aTownListW2_Listener,aTownListW2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;N&quot;,&quot;aDateFromListW2_Listener_&quot;,aDateFromListW2_Listener,aDateFromListW2)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;O&quot;,&quot;aDateToListW2_Listener_&quot;,aDateToListW2_Listener,aDateToListW2)
    notCallListener = false
End Sub




&apos;*************************************
&apos;Add Row Functionality
&apos;A_Basic_Info - Part6
&apos;Case : Self
&apos;*************************************
Sub addRow_A_Basic_Info_Sec6List()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;ExemptCerti.ListS&quot;)
    Call resetExemptionCertiRange(&quot;ExemptCertiS&quot;,&quot;A_Basic_Info&quot;)
    &apos;Add All Remove Listeners
   	call removeKRAListners(chkExemtionCertiNoS_Listener,chkExemtionCertiNoS)
	call removeKRAListners(chkExemtionCertiDateFromS_Listener,chkExemtionCertiDateFromS)
	call removeKRAListners(chkExemtionCertiDateToS_Listener,chkExemtionCertiDateToS)
	
	&apos;Add all Listners
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoS_Listener_&quot;,chkExemtionCertiNoS_Listener,chkExemtionCertiNoS)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromS_Listener_&quot;,chkExemtionCertiDateFromS_Listener,chkExemtionCertiDateFromS)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToS_Listener_&quot;,chkExemtionCertiDateToS_Listener,chkExemtionCertiDateToS)

   notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;A_Basic_Info - Part6
&apos;Case : Wife
&apos;*************************************
Sub addRow_A_Basic_Info_Sec6ListWife()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;ExemptCerti.ListW&quot;)
    Call resetExemptionCertiRange(&quot;ExemptCertiW&quot;,&quot;A_Basic_Info&quot;)
    &apos;Add All Remove Listeners
   	call removeKRAListners(chkExemtionCertiNoW_Listener,chkExemtionCertiNoW)
	call removeKRAListners(chkExemtionCertiDateFromW_Listener,chkExemtionCertiDateFromW)
	call removeKRAListners(chkExemtionCertiDateToW_Listener,chkExemtionCertiDateToW)
	
	&apos;Add all Listners
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoW_Listener_&quot;,chkExemtionCertiNoW_Listener,chkExemtionCertiNoW)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromW_Listener_&quot;,chkExemtionCertiDateFromW_Listener,chkExemtionCertiDateFromW)
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToW_Listener_&quot;,chkExemtionCertiDateToW_Listener,chkExemtionCertiDateToW)

   notCallListener = false
End Sub


&apos;*************************************
&apos;Check on PIN Number
&apos;A_Basic_Info
&apos;*************************************
sub chkPinNo_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkPinNo_Listener,chkPinNo)
	
	&apos;code
	Unprotectsheet(&quot;A_Basic_Info&quot;)	
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.PIN&quot;,&quot;chkPinNo_Listener_&quot;,chkPinNo_Listener,chkPinNo)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If	
	
	Dim sheet as Object
	Dim msgStr As String
	Dim taxPyrPINNo as String

	sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	taxPyrPINNo= sheet.getCellrangeByName(&quot;RetInf.PIN&quot;).string
 
   If TestPINMain(taxPyrPINNo)=False And taxPyrPINNo&lt;&gt;&quot;&quot; then
	     MsgBox &quot;Please enter valid Individual Personal Identification Number.&quot;
	     sheet.getCellrangeByName(&quot;RetInf.PIN&quot;).string=&quot;&quot;
   Else
   		sheet.getCellrangeByName(&quot;RetInf.PIN&quot;).string=Ucase(taxPyrPINNo)
   End If
	protectsheet(&quot;A_Basic_Info&quot;)
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.PIN&quot;,&quot;chkPinNo_Listener_&quot;,chkPinNo_Listener,chkPinNo)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Wife Income Choice
&apos;A_Basic_Info
&apos;*************************************
sub chkWifeIncomeChoice_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkWifeIncomeChoice_Listener,chkWifeIncomeChoice)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.DeclareWifeIncome&quot;,&quot;chkWifeIncomeChoice_Listener_&quot;,chkWifeIncomeChoice_Listener,chkWifeIncomeChoice)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************

		Unprotectsheet(&quot;A_Basic_Info&quot;)
		
		Dim sheet as Object
		Dim msgStr As String
		Dim WifeIncomeChoice as String
	
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		WifeIncomeChoice= sheet.getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;).string
		
		If (WifeIncomeChoice=&quot;Yes&quot;) Then
			lockCell = False
			oSheet = ThisComponent.sheets.getByName(&quot;B_Profit_Loss_Account_Wife&quot;)
			oSheet.isVisible = True
			oSheet = ThisComponent.sheets.getByName(&quot;T_Income_Computation_Wife&quot;)
			oSheet.isVisible = True
		elseIf (WifeIncomeChoice=&quot;No&quot;) Then
			lockCell = True
			oSheet = ThisComponent.sheets.getByName(&quot;B_Profit_Loss_Account_Wife&quot;)
			oSheet.isVisible = False
			oSheet = ThisComponent.sheets.getByName(&quot;T_Income_Computation_Wife&quot;)
			oSheet.isVisible = False
		else
			lockCell = False
			oSheet = ThisComponent.sheets.getByName(&quot;B_Profit_Loss_Account_Wife&quot;)
			oSheet.isVisible = True
			oSheet = ThisComponent.sheets.getByName(&quot;T_Income_Computation_Wife&quot;)
			oSheet.isVisible = True
		End If
		call toggleSpouseFields(lockCell)
	&apos;***	
	  	protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.DeclareWifeIncome&quot;,&quot;chkWifeIncomeChoice_Listener_&quot;,chkWifeIncomeChoice_Listener,chkWifeIncomeChoice)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

sub rtnPeriodFrom_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(rtnPeriodFrom_Listener,rtnPeriodFrom)
	
	&apos;code

	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		
		Dim dateFrom As String
		Dim dateTo As String
		Dim dateToObject as Object
		Dim dateFromObject as Object
		Dim year as Integer
	&apos;***	

			Unprotectsheet(&quot;A_Basic_Info&quot;)
			dateFrom= ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
			dateFromObject= ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;)
			dateTo= ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
			dateToObject= ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;)
			year = INT(getYear(dateFrom))
			
	         If dateFrom&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateFrom) = False) Then
			         dateFromObject.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	   		    	If checkFutureDate(dateFrom)= false then
						MsgBox &quot;You cannot file the return for the period whose date of Return Period From and / or Return Period To is a future date.&quot;
						dateFromObject.string = &quot;&quot;
					Else
		        	    dateToObject.string=&quot;&quot;
		        	    If INT(getYear(dateFrom))&lt; 2001 then
		        	    	dateFromObject.string = &quot;&quot;
	                		MsgBox &quot;Please enter date in Return Period From with year on or after 2001.&quot;
		        	    End If
		        	    If dateFromObject.string&lt;&gt;&quot;&quot; and dateToObject.string&lt;&gt;&quot;&quot; and checkGrtrThnNotEqlDate(dateFrom,dateTo)=False then
		                		dateFromObject.string = &quot;&quot;
		                		MsgBox &quot;Please enter date in Return Period From on or before date in Return Period To.&quot;
		                End If
		            End If
		         End If
		     Else
		     	dateToObject.string=&quot;&quot;
	         End If
	&apos;***	
			If dateToObject.string=&quot;&quot; then
			  	ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.dateforAuditCertificate&quot;).string=&quot;&quot;
			End If
			
			&apos;Added by vaishali gohil
			 
                If (year &lt;= 2016) Then 
                    Unprotectsheet(&quot;T_Tax_Computation&quot;)
                    ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.Mortgage&quot;).string = &quot;Mortgage Interest  (Total of Amount of Interest Paid from J_Computation_of_Mortgage  but subject to Maximum 1,50,000 Ksh)&quot;
                  
                    ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.PersonalReliefS&quot;).string =&quot;&quot;
                    
                    If(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;).string = &quot;Yes&quot;) Then
                    
                    ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.PersonalReliefW&quot;).string =&quot;&quot;                   
                    End If
                    
                    protectsheet(&quot;T_Tax_Computation&quot;)
                End If
                If (year = 2017) Then
                    Unprotectsheet(&quot;T_Tax_Computation&quot;)
                    ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.Mortgage&quot;).string = &quot;Mortgage Interest  (Total of Amount of Interest Paid from J_Computation_of_Mortgage  but subject to Maximum 3,00,000 Ksh)&quot;
                   
                    ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.PersonalReliefS&quot;).string =&quot;&quot;
                    
                     If(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;).string=&quot;Yes&quot;) Then
                   
                    ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.PersonalReliefW&quot;).string =&quot;&quot;                   
                    End If
                    
                    protectsheet(&quot;T_Tax_Computation&quot;)
                End If
                &apos;Added by vaishali gohil end
			protectsheet(&quot;A_Basic_Info&quot;)
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.RetStartDate&quot;,&quot;rtnPeriodFrom_&quot;,rtnPeriodFrom_Listener,rtnPeriodFrom)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

sub rtnPeriodTo_modified(oEv)
	if (notCallListener) then  
		exit Sub 
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(rtnPeriodTo_Listener,rtnPeriodTo)
	
	&apos;code

	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		
		Dim dateFrom As String
		Dim dateTo As String
		Dim dateToObject as Object
		Dim currentToDate as Date
	&apos;***	

			Unprotectsheet(&quot;A_Basic_Info&quot;)
			dateFrom= ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
			dateFromObject= ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;)
			dateTo= ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
			dateToObject= ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;)
			
	         If dateTo&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateTo) = False) Then
			         dateToObject.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	   		      If dateFrom&lt;&gt;&quot;&quot; then
		   		    	If checkFutureDate(dateTo)= false then
							MsgBox &quot;You cannot file the return for the period whose date of Return Period From and / or Return Period To is a future date.&quot;
							dateToObject.string = &quot;&quot;
						Else
			        	    If dateFrom&lt;&gt;&quot;&quot; and dateTo&lt;&gt;&quot;&quot; then
				        	    If getYear(dateTo)&lt;&gt;getYear(dateFrom) and getYear(dateFrom) &lt;&gt; &quot;False&quot; and getYear(dateTo) &lt;&gt; &quot;False&quot; then
				        	    	dateToObject.string=&quot;&quot;
			                		MsgBox &quot;The year in Return Period From and Return Period To should be same.&quot;
				        	    End If
				        	End If
			        	    If dateFromObject.string&lt;&gt;&quot;&quot; and dateToObject.string&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
			                		dateToObject.string=&quot;&quot;
			                		MsgBox &quot;The date in Return Period To should be same as or after the date in Return Period From.&quot;
			                End If
			                If dateToObject.string&lt;&gt;&quot;&quot; then
			                	currentToDate = DateSerial(getYear(dateTo), getMonth(dateTo), getDay(dateTo))
			                	auditEndDate = Format(DateAdd(&quot;m&quot;,6,currentToDate), &quot;dd/mm/yyyy&quot;)
								ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.dateforAuditCertificate&quot;).string=CStr(auditEndDate)
			                End If
			            End If
			       Else
			       		dateToObject.string=&quot;&quot;
			            MsgBox &quot;Please enter Return Period From first.&quot;
			       End If
	             End If
	         End If
	&apos;***	
			If dateToObject.string=&quot;&quot; then
			  	ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.dateforAuditCertificate&quot;).string=&quot;&quot;
			End If
			protectsheet(&quot;A_Basic_Info&quot;)
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.RetEndDate&quot;,&quot;rtnPeriodTo_&quot;,rtnPeriodTo_Listener,rtnPeriodTo)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

Function getYear(strDate as String)
	
	Dim mm As String
	Dim yy As String
	Dim dd as String
	Dim strDateObj As Object
	
	getYear = &quot;False&quot;
	
	If strDate&lt;&gt;&quot;&quot; then
		if ValidateDate(strDate) then
			 strDateObj= Split(strDate, &quot;/&quot;)
			 dd= strDateObj(0)
			 mm= strDateObj(1)
			 yy= strDateObj(2)
			 getYear = yy
		End If
	End If
	
End Function

Function getMonth(strDate as String)
	
	Dim mm As String
	Dim yy As String
	Dim dd as String
	Dim strDateObj As Object
	
	getMonth = &quot;False&quot;
	
	If strDate&lt;&gt;&quot;&quot; then
		if ValidateDate(strDate) then
			 strDateObj= Split(strDate, &quot;/&quot;)
			 dd= strDateObj(0)
			 mm= strDateObj(1)
			 yy= strDateObj(2)
			 getMonth = mm
		End If
	End If
	
End Function

Function getDay(strDate as String)
	
	Dim mm As String
	Dim yy As String
	Dim dd as String
	Dim strDateObj As Object
	
	getDay = &quot;False&quot;
	
	If strDate&lt;&gt;&quot;&quot; then
		if ValidateDate(strDate) then
			 strDateObj= Split(strDate, &quot;/&quot;)
			 dd= strDateObj(0)
			 mm= strDateObj(1)
			 yy= strDateObj(2)
			 getDay = dd
		End If
	End If
	
End Function

&apos;*************************************
&apos;Check on Wife&apos;s PIN Number
&apos;A_Basic_Info
&apos;*************************************
sub chkWifePin_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkWifePin_Listener,chkWifePin)
	
	&apos;code
	Unprotectsheet(&quot;A_Basic_Info&quot;)	
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.SpousePIN&quot;,&quot;chkWifePin_Listener_&quot;,chkWifePin_Listener,chkWifePin)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If	
	
	Dim sheet as Object
	Dim msgStr As String
	Dim taxPyrPINNo as String
	Dim taxPyrSpousePINNo as String

	sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	taxPyrPINNo= sheet.getCellrangeByName(&quot;RetInf.PIN&quot;).string
	taxPyrSpousePINNo= sheet.getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string
 	
    If TestPINMain(taxPyrSpousePINNo)=False And taxPyrSpousePINNo&lt;&gt;&quot;&quot; then
	     MsgBox &quot;Please enter valid Individual Personal Identification Number.&quot;
	     sheet.getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string=&quot;&quot;
	ElseIf (Ucase(taxPyrSpousePINNo) = Ucase(taxPyrPINNo)) Then
	     sheet.getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string=&quot;&quot;
	     MsgBox &quot;PIN entered should not be same as Taxpayer&apos;s PIN.&quot;
	Else
		 sheet.getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string=Ucase(taxPyrSpousePINNo)
	End If
	protectsheet(&quot;A_Basic_Info&quot;)
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.SpousePIN&quot;,&quot;chkWifePin_Listener_&quot;,chkWifePin_Listener,chkWifePin)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Bank Name
&apos;A_Basic_Info
&apos;*************************************
	sub chkBankName_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkBankName_Listener,chkBankName)
	
	&apos;code
	Unprotectsheet(&quot;A_Basic_Info&quot;)	
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;BankS&quot;,&quot;chkBankName_Listener_&quot;,chkBankName_Listener,chkBankName)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If	
	
	Dim sheet as Object
	Dim msgStr As String
	Dim bnkName as String

	sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	bnkName= sheet.getCellrangeByName(&quot;BankS&quot;).string
 
   	sheet.getCellrangeByName(&quot;BranchS&quot;).string=&quot;&quot;
	protectsheet(&quot;A_Basic_Info&quot;)
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;BankS&quot;,&quot;chkBankName_Listener_&quot;,chkBankName_Listener,chkBankName)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
	
&apos;*************************************
&apos;Check on PIN Of Auditor
&apos;A_Basic_Info
&apos;Case : Self
&apos;*************************************
sub chkPinOfAuditor_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkPinOfAuditor_Listener,chkPinOfAuditor)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;audit.PINOfAuditorS&quot;,&quot;chkPinOfAuditor_Listener_&quot;,chkPinOfAuditor_Listener,chkPinOfAuditor)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
		UnprotectSheet(&quot;A_Basic_Info&quot;)	
		Dim sheet as Object
		Dim msgStr As String
		Dim taxPyrPINNo as String
		Dim taxPyrWifePINNo as String
		Dim auditorPIN as String
		Dim declareWifeIncome as String
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		auditorPIN= sheet.getCellrangeByName(&quot;audit.PINOfAuditorS&quot;).string
		taxPyrWifePINNo=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string
		declareWifeIncome = ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;).string
		taxPyrPINNo= ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.PIN&quot;).string
		
	   If auditorPIN&lt;&gt;&quot;&quot; then
	   	sheet.getCellrangeByName(&quot;audit.PINOfAuditorS&quot;).string=Ucase(auditorPIN)
		  If TestPINPartnership(auditorPIN)=False then
			     MsgBox msgPinFrmt
			     sheet.getCellrangeByName(&quot;audit.PINOfAuditorS&quot;).string=&quot;&quot;
		  Else
		  	If 	taxPyrPINNo&lt;&gt;&quot;&quot; or taxPyrWifePINNo&lt;&gt;&quot;&quot; then
		  		If UCase(taxPyrPINNo) = Ucase(auditorPIN) then
		  	     MsgBox msgPinDup
			     sheet.getCellrangeByName(&quot;audit.PINOfAuditorS&quot;).string=&quot;&quot;	
			    ElseIf UCase(taxPyrWifePINNo) = Ucase(auditorPIN) and declareWifeIncome&lt;&gt;&quot;No&quot; then
			     MsgBox msgPinDupWife
			     sheet.getCellrangeByName(&quot;audit.PINOfAuditorS&quot;).string=&quot;&quot;	
		  		End If
		  	End If	
		  	
		  End If
	  End If
	  ProtectSheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;audit.PINOfAuditorS&quot;,&quot;chkPinOfAuditor_Listener_&quot;,chkPinOfAuditor_Listener,chkPinOfAuditor)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Date Of Audit
&apos;A_Basic_Info
&apos;Case : Self
&apos;*************************************
sub chkDateOfAudit_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkDateOfAudit_Listener,chkDateOfAudit)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;audit.DateOfAuditCertiS&quot;,&quot;chkDateOfAudit_Listener_&quot;,chkDateOfAudit_Listener,chkDateOfAudit)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
		Dim currRange as Object
		Dim endDate as String
		
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		auditDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.dateforAuditCertificate&quot;).string
		Dim auditCertiDate As String
		Dim auditStartDate as String
		Dim yr as Integer
		Dim strDate as Object
		Dim currentToDate as Date
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			auditCertiDate= currRange.string
			If auditCertiDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(auditCertiDate) = False) Then
			         currRange.string = &quot;&quot;
			         MsgBox msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
	              	ElseIf TestAuditDate(auditCertiDate)=False Then
			        		   currRange.string = &quot;&quot;
			        		   currentToDate = DateSerial(getYear(endDate), getMonth(endDate), getDay(endDate))
		                	   auditStartDate = CStr(Format(DateAdd(&quot;d&quot;,1,currentToDate), &quot;dd/mm/yyyy&quot;))
		  			          MsgBox &quot;Date of Audit Certificate should be between &quot; &amp; auditStartDate &amp; &quot; and &quot; &amp; auditDate &amp; &quot;.&quot; 
				    End If
	         	End If
	         End If
			
		End If
		
	&apos;***	
	  	protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;audit.DateOfAuditCertiS&quot;,&quot;chkDateOfAudit_Listener_&quot;,chkDateOfAudit_Listener,chkDateOfAudit)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on PIN Of Auditor
&apos;A_Basic_Info
&apos;Case : Wife
&apos;*************************************
sub chkPinOfAuditorW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkPinOfAuditorW_Listener,chkPinOfAuditorW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;audit.PINOfAuditorW&quot;,&quot;chkPinOfAuditorW_Listener_&quot;,chkPinOfAuditorW_Listener,chkPinOfAuditorW)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
		UnprotectSheet(&quot;A_Basic_Info&quot;)	
		Dim sheet as Object
		Dim msgStr As String
		Dim taxPyrPINNo as String
		Dim auditorPIN as String
		Dim taxPyrWifePINNo as String
		Dim declareWifeIncome as String
		
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		auditorPIN= sheet.getCellrangeByName(&quot;audit.PINOfAuditorW&quot;).string
		taxPyrPINNo= ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.PIN&quot;).string
		taxPyrWifePINNo=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string
		declareWifeIncome = ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;).string
		
	   If auditorPIN&lt;&gt;&quot;&quot; then
	   	sheet.getCellrangeByName(&quot;audit.PINOfAuditorW&quot;).string=Ucase(auditorPIN)
		  If TestPINPartnership(auditorPIN)=False then
			     MsgBox msgPinFrmt
			     sheet.getCellrangeByName(&quot;audit.PINOfAuditorW&quot;).string=&quot;&quot;
		  Else
		  	If 	taxPyrPINNo&lt;&gt;&quot;&quot; or taxPyrWifePINNo&lt;&gt;&quot;&quot; then
		  		If UCase(taxPyrPINNo) = Ucase(auditorPIN) then
		  	     MsgBox &quot;PIN entered should not be same as Taxpayer&apos;s PIN.&quot;
			     sheet.getCellrangeByName(&quot;audit.PINOfAuditorW&quot;).string=&quot;&quot;	
			    ElseIf UCase(taxPyrWifePINNo) = Ucase(auditorPIN) and declareWifeIncome&lt;&gt;&quot;No&quot; then
			     MsgBox msgPinDupWife
			     sheet.getCellrangeByName(&quot;audit.PINOfAuditorW&quot;).string=&quot;&quot;	
		  		End If
		  	End If	
		  End If
	  End If
	  ProtectSheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;audit.PINOfAuditorW&quot;,&quot;chkPinOfAuditorW_Listener_&quot;,chkPinOfAuditorW_Listener,chkPinOfAuditorW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Date Of Audit
&apos;A_Basic_Info
&apos;Case : Wife
&apos;*************************************
sub chkDateOfAuditW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkDateOfAuditW_Listener,chkDateOfAuditW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;audit.DateOfAuditCertiW&quot;,&quot;chkDateOfAuditW_Listener_&quot;,chkDateOfAuditW_Listener,chkDateOfAuditW)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
		Dim currRange as Object
		Dim endDate as String
		Dim auditDate as String
		
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		auditDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.dateforAuditCertificate&quot;).string
		Dim auditCertiDate As String
		Dim auditStartDate as String
		Dim yr as Integer
		Dim strDate as Object
		Dim currentToDate as Date
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			auditCertiDate= currRange.string
			If auditCertiDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(auditCertiDate) = False) Then
			         currRange.string = &quot;&quot;
			         MsgBox msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
	              	ElseIf TestAuditDate(auditCertiDate)=False Then
			        		   currRange.string = &quot;&quot;
			        		   currentToDate = DateSerial(getYear(endDate), getMonth(endDate), getDay(endDate))
		                	   auditStartDate = CStr(Format(DateAdd(&quot;d&quot;,1,currentToDate), &quot;dd/mm/yyyy&quot;))
		  			          MsgBox &quot;Date of Audit Certificate should be between &quot; &amp; auditStartDate &amp; &quot; and &quot; &amp; auditDate &amp; &quot;.&quot; 
				    End If
	         	End If
	         End If
			
		End If
		
	&apos;***	
	  	protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;audit.DateOfAuditCertiW&quot;,&quot;chkDateOfAuditW_Listener_&quot;,chkDateOfAuditW_Listener,chkDateOfAuditW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
	
&apos;*************************************
&apos;Check on PIN Of LandLord
&apos;A_Basic_Info - Part1
&apos;Case : Self
&apos;*************************************
sub aPinOfLandLordList1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aPinOfLandLordList1_Listener,aPinOfLandLordList1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;A&quot;,&quot;aPinOfLandLordList1_Listener_&quot;,aPinOfLandLordList1_Listener,aPinOfLandLordList1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;A&quot;&amp;(startRowNum+1)&amp;&quot;:A&quot;&amp;(endRowNum+1))
		Unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim PINNo as String
		Dim taxPyrPINNo as String
		Dim taxPyrWifePINNo as String
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		taxPyrPINNo= sheet.getCellrangeByName(&quot;RetInf.PIN&quot;).string
		taxPyrWifePINNo=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string
		declareWifeIncome = ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;).string
		
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			PINNo= currRange.string
			row= currRange.getCellAddress().Row 
	
			 If PINNo &lt;&gt; &quot;&quot; Then
			  currRange.string=Ucase(PINNo)
			    If (TestPIN(PINNo)) Then
			    	If 	taxPyrPINNo&lt;&gt;&quot;&quot; or taxPyrWifePINNo&lt;&gt;&quot;&quot; then
					    If (Ucase(PINNo) = Ucase(taxPyrPINNo)) Then
					          	msgStr=msgStr &amp; (row+1)
					            currRange.string=&quot;&quot;
					            MsgBox &quot;PIN entered should not be same as Taxpayer&apos;s PIN.&quot;
					    ElseIf UCase(taxPyrWifePINNo) = Ucase(PINNo) and declareWifeIncome&lt;&gt;&quot;No&quot; then
					    		msgStr=msgStr &amp; (row+1)
					            currRange.string=&quot;&quot;
					    		MsgBox msgPinDupWife
					    End If
					 End If
		  	    Else
	   	    		msgStr=msgStr &amp; (row+1)
	   	    		currRange.string=&quot;&quot;
					MsgBox &quot;Please enter PIN of Landlord in proper format.&quot;
		  	    End If
		     End If
		End If
		
	&apos;***	
	  	protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;A&quot;,&quot;aPinOfLandLordList1_Listener_&quot;,aPinOfLandLordList1_Listener,aPinOfLandLordList1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on County
&apos;A_Basic_Info - Part1
&apos;Case : Self
&apos;*************************************
sub aCountyList1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aCountyList1_Listener,aCountyList1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;G&quot;,&quot;aCountyList1_Listener_&quot;,aCountyList1_Listener,aCountyList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;G&quot;&amp;(startRowNum+1)&amp;&quot;:G&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;CountyName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(15,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;R&quot;&amp;(row+1)&amp;&quot;:R&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(14,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;R&quot;&amp;(row+1)&amp;&quot;:R&quot;&amp;(row+1)).string=&quot;&quot;
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=&quot;&quot;
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	     
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string=&quot;&quot;
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;G&quot;,&quot;aCountyList1_Listener_&quot;,aCountyList1_Listener,aCountyList1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on District
&apos;A_Basic_Info - Part1
&apos;Case : Self
&apos;*************************************
sub aDistrictList1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDistrictList1_Listener,aDistrictList1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;H&quot;,&quot;aDistrictList1_Listener_&quot;,aDistrictList1_Listener,aDistrictList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;H&quot;&amp;(startRowNum+1)&amp;&quot;:H&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;districtName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(27,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(26,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=&quot;&quot;
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string=&quot;&quot;
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;H&quot;,&quot;aDistrictList1_Listener_&quot;,aDistrictList1_Listener,aDistrictList1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Business Locality
&apos;A_Basic_Info - Part1
&apos;Case : Self
&apos;*************************************
sub aBusinessLocalityList1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aBusinessLocalityList1_Listener,aBusinessLocalityList1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;I&quot;,&quot;aBusinessLocalityList1_Listener_&quot;,aBusinessLocalityList1_Listener,aBusinessLocalityList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;I&quot;&amp;(startRowNum+1)&amp;&quot;:I&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;localityName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(31,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(30,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;I&quot;,&quot;aBusinessLocalityList1_Listener_&quot;,aBusinessLocalityList1_Listener,aBusinessLocalityList1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Town
&apos;A_Basic_Info - Part1
&apos;Case : Self
&apos;*************************************
sub aTownList1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aTownList1_Listener,aTownList1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;L&quot;,&quot;aTownList1_Listener_&quot;,aTownList1_Listener,aTownList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;L&quot;&amp;(startRowNum+1)&amp;&quot;:L&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;Town&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(13,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;M&quot;&amp;(row+1)&amp;&quot;:M&quot;&amp;(row+1)).string=sheet.getCellByPosition(12,i).string
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;M&quot;&amp;(row+1)&amp;&quot;:M&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;L&quot;,&quot;aTownList1_Listener_&quot;,aTownList1_Listener,aTownList1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub



&apos;========================================================
&apos;Added By Sandeep Thaker(671333)
&apos;========================================================
sub aPostalCodeList1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aPostalCodeList1_Listener,aPostalCodeList1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;M&quot;,&quot;aPostalCodeList1_Listener_&quot;,aPostalCodeList1_Listener,aPostalCodeList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;M&quot;&amp;(startRowNum+1)&amp;&quot;:M&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;PostalCode&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(12,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;L&quot;&amp;(row+1)&amp;&quot;:L&quot;&amp;(row+1)).string=sheet.getCellByPosition(13,i).string
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;L&quot;&amp;(row+1)&amp;&quot;:L&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;M&quot;,&quot;aPostalCodeList1_Listener_&quot;,aPostalCodeList1_Listener,aPostalCodeList1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Date From
&apos;A_Basic_Info - Part1
&apos;Case : Self
&apos;*************************************
sub aDateFromList1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDateFromList1_Listener,aDateFromList1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;N&quot;,&quot;aDateFromList2_Listener_&quot;,aDateFromList2_Listener,aDateFromList2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		Dim endDate as String
		Dim startDate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;N&quot;&amp;(startRowNum+1)&amp;&quot;:N&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateFrom As String
		Dim dateTo As String
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateFrom= currRange.string
			row= currRange.getCellAddress().Row 
			dateTo= oSheet.getCellrangeByName(&quot;O&quot; &amp; (row+1)  &amp; &quot;:O&quot; &amp; (row+1)).string 
	         If dateFrom&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateFrom) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateFrom)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date From in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateTo&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date From in Row &quot; &amp; (row+1) &amp; &quot; should be same as or before Date To &quot;
	                End If
	             End If
	         End If
		End If
	&apos;***	
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;N&quot;,&quot;aDateFromList1_Listener_&quot;,aDateFromList1_Listener,aDateFromList1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Date To
&apos;A_Basic_Info - Part1
&apos;Case : Self
&apos;*************************************
sub aDateToList1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDateToList1_Listener,aDateToList1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;O&quot;,&quot;aDateToList1_Listener_&quot;,aDateToList1_Listener,aDateToList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
		Dim endDate as String
		Dim startdate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;O&quot;&amp;(startRowNum+1)&amp;&quot;:O&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateFrom As String
		Dim dateTo As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateTo= currRange.string
			row= currRange.getCellAddress().Row 
			dateFrom= oSheet.getCellrangeByName(&quot;N&quot; &amp; (row+1)  &amp; &quot;:N&quot; &amp; (row+1)).string 
	         If dateTo&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateTo) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateTo)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date To in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateFrom&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date To in Row &quot; &amp; (row+1) &amp; &quot; should be same as or after Date From &quot;
	                End If
	             End If
	         End If
	       else
		End If
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;O&quot;,&quot;aDateToList1_Listener_&quot;,aDateToList1_Listener,aDateToList1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
	
&apos;*************************************
&apos;Check on Pin Of Tenant
&apos;A_Basic_Info - Part2
&apos;Case : Self
&apos;*************************************
sub aPinOfTenantList2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aPinOfTenantList2_Listener,aPinOfTenantList2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;A&quot;,&quot;aPinOfLandLordList1_Listener_&quot;,aPinOfLandLordList1_Listener,aPinOfLandLordList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;A&quot;&amp;(startRowNum+1)&amp;&quot;:A&quot;&amp;(endRowNum+1))
		Unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim PINNo as String
		Dim taxPyrPINNo as String
		Dim taxPyrWifePINNo as String
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		taxPyrPINNo= sheet.getCellrangeByName(&quot;RetInf.PIN&quot;).string
		taxPyrWifePINNo=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string
		declareWifeIncome = ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;).string
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			PINNo= currRange.string
			row= currRange.getCellAddress().Row 
	
			 If PINNo &lt;&gt; &quot;&quot; Then
			  currRange.string=Ucase(PINNo)
			    If (TestPIN(PINNo)) Then
			    	If 	taxPyrPINNo&lt;&gt;&quot;&quot; or taxPyrWifePINNo&lt;&gt;&quot;&quot; then
					    If (Ucase(PINNo) = Ucase(taxPyrPINNo)) Then
					          	msgStr=msgStr &amp; (row+1)
					            currRange.string=&quot;&quot;
					            MsgBox &quot;PIN entered should not be same as Taxpayer&apos;s PIN.&quot;
					    ElseIf UCase(taxPyrWifePINNo) = Ucase(PINNo) and declareWifeIncome&lt;&gt;&quot;No&quot; then
					    		msgStr=msgStr &amp; (row+1)
					            currRange.string=&quot;&quot;
					    		MsgBox msgPinDupWife
					    End If
					 End If
		  	    Else
	   	    		msgStr=msgStr &amp; (row+1)
	   	    		currRange.string=&quot;&quot;
					MsgBox &quot;Please enter PIN of Tenant in proper format.&quot;
		  	    End If
		     End If
		End If
		
	&apos;***	
	  	protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;A&quot;,&quot;aPinOfTenantList2_Listener_&quot;,aPinOfTenantList2_Listener,aPinOfTenantList2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on County
&apos;A_Basic_Info - Part2
&apos;Case : Self
&apos;*************************************
sub aCountyList2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aCountyList2_Listener,aCountyList2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;G&quot;,&quot;aCountyList2_Listener_&quot;,aCountyList2_Listener,aCountyList2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
		End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;G&quot;&amp;(startRowNum+1)&amp;&quot;:G&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;CountyName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(15,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;R&quot;&amp;(row+1)&amp;&quot;:R&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(14,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;R&quot;&amp;(row+1)&amp;&quot;:R&quot;&amp;(row+1)).string=&quot;&quot;
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=&quot;&quot;
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	     
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string=&quot;&quot;
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;G&quot;,&quot;aCountyList2_Listener_&quot;,aCountyList2_Listener,aCountyList2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on District
&apos;A_Basic_Info - Part2
&apos;Case : Self
&apos;*************************************
sub aDistrictList2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDistrictList2_Listener,aDistrictList2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;H&quot;,&quot;aDistrictList1_Listener_&quot;,aDistrictList1_Listener,aDistrictList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;H&quot;&amp;(startRowNum+1)&amp;&quot;:H&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;districtName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(27,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(26,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=&quot;&quot;
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string=&quot;&quot;
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;H&quot;,&quot;aDistrictList2_Listener_&quot;,aDistrictList2_Listener,aDistrictList2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Business Locality
&apos;A_Basic_Info - Part2
&apos;Case : Self
&apos;*************************************
sub aBusinessLocalityList2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aBusinessLocalityList2_Listener,aBusinessLocalityList2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;I&quot;,&quot;aBusinessLocalityList1_Listener_&quot;,aBusinessLocalityList1_Listener,aBusinessLocalityList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;I&quot;&amp;(startRowNum+1)&amp;&quot;:I&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;localityName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(31,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(30,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;I&quot;,&quot;aBusinessLocalityList2_Listener_&quot;,aBusinessLocalityList2_Listener,aBusinessLocalityList2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Town
&apos;A_Basic_Info - Part2
&apos;Case : Self
&apos;*************************************
sub aTownList2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aTownList2_Listener,aTownList2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;L&quot;,&quot;aTownList1_Listener_&quot;,aTownList1_Listener,aTownList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;L&quot;&amp;(startRowNum+1)&amp;&quot;:L&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;Town&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(13,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;M&quot;&amp;(row+1)&amp;&quot;:M&quot;&amp;(row+1)).string=sheet.getCellByPosition(12,i).string
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;M&quot;&amp;(row+1)&amp;&quot;:M&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;L&quot;,&quot;aTownList2_Listener_&quot;,aTownList2_Listener,aTownList2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;================================================================
&apos;Added By Sandeep Thaker(671333)
&apos;=================================================================
sub aPostalCodeList2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aPostalCodeList2_Listener,aPostalCodeList2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;M&quot;,&quot;aPostalCodeList1_Listener_&quot;,aPostalCodeList1_Listener,aPostalCodeList1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;M&quot;&amp;(startRowNum+1)&amp;&quot;:M&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;PostalCode&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(12,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;L&quot;&amp;(row+1)&amp;&quot;:L&quot;&amp;(row+1)).string=sheet.getCellByPosition(13,i).string
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;L&quot;&amp;(row+1)&amp;&quot;:L&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;M&quot;,&quot;aPostalCodeList2_Listener_&quot;,aPostalCodeList2_Listener,aPostalCodeList2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;================================================================
&apos;Added By Sandeep Thaker(671333)
&apos;================================================================
&apos;*************************************
&apos;Check on Date From
&apos;A_Basic_Info - Part2
&apos;Case : Self
&apos;*************************************
sub aDateFromList2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDateFromList2_Listener,aDateFromList2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;N&quot;,&quot;aDateFromList2_Listener_&quot;,aDateFromList2_Listener,aDateFromList2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		Dim endDate as String
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;N&quot;&amp;(startRowNum+1)&amp;&quot;:N&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateFrom As String
		Dim dateTo As String
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateFrom= currRange.string
			row= currRange.getCellAddress().Row 
			dateTo= oSheet.getCellrangeByName(&quot;O&quot; &amp; (row+1)  &amp; &quot;:O&quot; &amp; (row+1)).string 
	         If dateFrom&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateFrom) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateFrom)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date From in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateTo&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date From in Row &quot; &amp; (row+1) &amp; &quot; should be same as or before Date To &quot;
	                End If
	             End If
	         End If
		End If
	&apos;***	
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;N&quot;,&quot;aDateFromList2_Listener_&quot;,aDateFromList2_Listener,aDateFromList2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Date To
&apos;A_Basic_Info - Part2
&apos;Case : Self
&apos;*************************************
sub aDateToList2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDateToList2_Listener,aDateToList2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;O&quot;,&quot;aDateToList2_Listener_&quot;,aDateToList2_Listener,aDateToList2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
	
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;O&quot;&amp;(startRowNum+1)&amp;&quot;:O&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateFrom As String
		Dim dateTo As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateTo= currRange.string
			row= currRange.getCellAddress().Row 
			dateFrom= oSheet.getCellrangeByName(&quot;N&quot; &amp; (row+1)  &amp; &quot;:N&quot; &amp; (row+1)).string 
	         If dateTo&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateTo) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateTo)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date To in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateFrom&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date To in Row &quot; &amp; (row+1) &amp; &quot; should be same as or after Date From &quot;
	                End If
	            End If
	         End If
		End If
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListS&quot;,&quot;O&quot;,&quot;aDateToList2_Listener_&quot;,aDateToList2_Listener,aDateToList2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Pin Of Landlord
&apos;A_Basic_Info - Part1
&apos;Case : Wife
&apos;*************************************
sub aPinOfLandLordListW1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aPinOfLandLordListW1_Listener,aPinOfLandLordListW1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;A&quot;,&quot;aPinOfLandLordListW1_Listener_&quot;,aPinOfLandLordListW1_Listener,aPinOfLandLordListW1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;A&quot;&amp;(startRowNum+1)&amp;&quot;:A&quot;&amp;(endRowNum+1))
		Unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim PINNo as String
		Dim taxPyrPINNo as String
		Dim taxPyrWifePINNo as String
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		taxPyrPINNo= sheet.getCellrangeByName(&quot;RetInf.PIN&quot;).string
		taxPyrWifePINNo=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string
		declareWifeIncome = ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;).string
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			PINNo= currRange.string
			row= currRange.getCellAddress().Row 
	
			 If PINNo &lt;&gt; &quot;&quot; Then
			  currRange.string=Ucase(PINNo)
			    If (TestPIN(PINNo)) Then
			    	If 	taxPyrPINNo&lt;&gt;&quot;&quot; or taxPyrWifePINNo&lt;&gt;&quot;&quot; then
					    If (Ucase(PINNo) = Ucase(taxPyrPINNo)) Then
					          	msgStr=msgStr &amp; (row+1)
					            currRange.string=&quot;&quot;
					            MsgBox &quot;PIN entered should not be same as Taxpayer&apos;s PIN.&quot;
					    ElseIf UCase(taxPyrWifePINNo) = Ucase(PINNo) and declareWifeIncome&lt;&gt;&quot;No&quot; then
					    		msgStr=msgStr &amp; (row+1)
					            currRange.string=&quot;&quot;
					    		MsgBox msgPinDupWife
					    End If
					 End If
		  	    Else
	   	    		msgStr=msgStr &amp; (row+1)
	   	    		currRange.string=&quot;&quot;
					MsgBox &quot;Please enter PIN of Landlord in proper format.&quot;
		  	    End If
		     End If
		End If
		
	&apos;***	
	  	protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;A&quot;,&quot;aPinOfLandLordListW1_Listener_&quot;,aPinOfLandLordListW1_Listener,aPinOfLandLordListW1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on County
&apos;A_Basic_Info - Part1
&apos;Case : Wife
&apos;*************************************
sub aCountyListW1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aCountyListW1_Listener,aCountyListW1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListS&quot;,&quot;G&quot;,&quot;aCountyListW1_Listener_&quot;,aCountyListW1_Listener,aCountyListW1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;G&quot;&amp;(startRowNum+1)&amp;&quot;:G&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;CountyName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(15,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;R&quot;&amp;(row+1)&amp;&quot;:R&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(14,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;R&quot;&amp;(row+1)&amp;&quot;:R&quot;&amp;(row+1)).string=&quot;&quot;
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=&quot;&quot;
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	     
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string=&quot;&quot;
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;G&quot;,&quot;aCountyListW1_Listener_&quot;,aCountyListW1_Listener,aCountyListW1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on District
&apos;A_Basic_Info - Part1
&apos;Case : Wife
&apos;*************************************
sub aDistrictListW1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDistrictListW1_Listener,aDistrictListW1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;H&quot;,&quot;aDistrictListW1_Listener_&quot;,aDistrictListW1_Listener,aDistrictListW1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;H&quot;&amp;(startRowNum+1)&amp;&quot;:H&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;districtName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(27,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(26,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=&quot;&quot;
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string=&quot;&quot;
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;H&quot;,&quot;aDistrictListW1_Listener_&quot;,aDistrictListW1_Listener,aDistrictListW1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Business Locality
&apos;A_Basic_Info - Part1
&apos;Case : Wife
&apos;*************************************
sub aBusinessLocalityListW1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aBusinessLocalityListW1_Listener,aBusinessLocalityListW1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;I&quot;,&quot;aBusinessLocalityListW1_Listener_&quot;,aBusinessLocalityListW1_Listener,aBusinessLocalityListW1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;I&quot;&amp;(startRowNum+1)&amp;&quot;:I&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;localityName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(31,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(30,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;I&quot;,&quot;aBusinessLocalityListW1_Listener_&quot;,aBusinessLocalityListW1_Listener,aBusinessLocalityListW1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Town
&apos;A_Basic_Info - Part1
&apos;Case : Wife
&apos;*************************************
sub aTownListW1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aTownListW1_Listener,aTownListW1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;L&quot;,&quot;aTownListW1_Listener_&quot;,aTownListW1_Listener,aTownListW1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;L&quot;&amp;(startRowNum+1)&amp;&quot;:L&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;Town&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(13,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;M&quot;&amp;(row+1)&amp;&quot;:M&quot;&amp;(row+1)).string=sheet.getCellByPosition(12,i).string
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;M&quot;&amp;(row+1)&amp;&quot;:M&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;L&quot;,&quot;aTownListW1_Listener_&quot;,aTownListW1_Listener,aTownListW1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub


&apos;================================================================
&apos;Added By Sandeep Thaker(671333)
&apos;================================================================
sub aPostalCodeListW1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aPostalCodeListW1_Listener,aPostalCodeListW1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;M&quot;,&quot;aPostalCodeListW1_Listener_&quot;,aPostalCodeListW1_Listener,aPostalCodeListW1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;M&quot;&amp;(startRowNum+1)&amp;&quot;:M&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;PostalCode&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(12,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;L&quot;&amp;(row+1)&amp;&quot;:L&quot;&amp;(row+1)).string=sheet.getCellByPosition(13,i).string
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;L&quot;&amp;(row+1)&amp;&quot;:L&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;M&quot;,&quot;aPostalCodeListW1_Listener_&quot;,aPostalCodeListW1_Listener,aPostalCodeListW1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;===============================================================
&apos;End of Added By Sandeep Thaker(671333)
&apos;===============================================================
&apos;*************************************
&apos;Check on Date From
&apos;A_Basic_Info - Part1
&apos;Case : Wife
&apos;*************************************
sub aDateFromListW1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDateFromListW1_Listener,aDateFromListW1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;N&quot;,&quot;aDateFromListW1_Listener_&quot;,aDateFromListW1_Listener,aDateFromListW1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		Dim endDate as String
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;N&quot;&amp;(startRowNum+1)&amp;&quot;:N&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateFrom As String
		Dim dateTo As String
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateFrom= currRange.string
			row= currRange.getCellAddress().Row 
			dateTo= oSheet.getCellrangeByName(&quot;O&quot; &amp; (row+1)  &amp; &quot;:O&quot; &amp; (row+1)).string 
	         If dateFrom&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateFrom) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateFrom)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date From in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateTo&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date From in Row &quot; &amp; (row+1) &amp; &quot; should be same as or before Date To &quot;
	                End If
	             End If
	         End If
		End If
	&apos;***	
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;N&quot;,&quot;aDateFromListW1_Listener_&quot;,aDateFromListW1_Listener,aDateFromListW1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Date To
&apos;A_Basic_Info - Part1
&apos;Case : Wife
&apos;*************************************
sub aDateToListW1_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDateToListW1_Listener,aDateToListW1)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;O&quot;,&quot;aDateToListW1_Listener_&quot;,aDateToListW1_Listener,aDateToListW1)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;O&quot;&amp;(startRowNum+1)&amp;&quot;:O&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateFrom As String
		Dim dateTo As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateTo= currRange.string
			row= currRange.getCellAddress().Row 
			dateFrom= oSheet.getCellrangeByName(&quot;N&quot; &amp; (row+1)  &amp; &quot;:N&quot; &amp; (row+1)).string 
	         If dateTo&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateTo) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateTo)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date To in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateFrom&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date To in Row &quot; &amp; (row+1) &amp; &quot; should be same as or after Date From &quot;
	                End If
	             End If
	         End If
	       else
		End If
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;O&quot;,&quot;aDateToListW1_Listener_&quot;,aDateToListW1_Listener,aDateToListW1)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
	
&apos;*************************************
&apos;Check on Pin Of Tenant
&apos;A_Basic_Info - Part2
&apos;Case : Wife
&apos;*************************************
sub aPinOfTenantListW2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aPinOfTenantListW2_Listener,aPinOfTenantListW2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;A&quot;,&quot;aPinOfTenantListW2_Listener_&quot;,aPinOfTenantListW2_Listener,aPinOfTenantListW2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;A&quot;&amp;(startRowNum+1)&amp;&quot;:A&quot;&amp;(endRowNum+1))
		Unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim PINNo as String
		Dim taxPyrPINNo as String
		Dim taxPyrWifePINNo as String
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		taxPyrPINNo= sheet.getCellrangeByName(&quot;RetInf.PIN&quot;).string
		taxPyrWifePINNo=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.SpousePIN&quot;).string
		declareWifeIncome = ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;).string
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			PINNo= currRange.string
			row= currRange.getCellAddress().Row 
	
			 If PINNo &lt;&gt; &quot;&quot; Then
			  currRange.string=Ucase(PINNo)
			    If (TestPIN(PINNo)) Then
			    	If 	taxPyrPINNo&lt;&gt;&quot;&quot; or taxPyrWifePINNo&lt;&gt;&quot;&quot; then
					    If (Ucase(PINNo) = Ucase(taxPyrPINNo)) Then
					          	msgStr=msgStr &amp; (row+1)
					            currRange.string=&quot;&quot;
					            MsgBox &quot;PIN entered should not be same as Taxpayer&apos;s PIN.&quot;
					    ElseIf UCase(taxPyrWifePINNo) = Ucase(PINNo) and declareWifeIncome&lt;&gt;&quot;No&quot; then
					    		msgStr=msgStr &amp; (row+1)
					            currRange.string=&quot;&quot;
					    		MsgBox msgPinDupWife
					    End If
					 End If
		  	    Else
	   	    		msgStr=msgStr &amp; (row+1)
	   	    		currRange.string=&quot;&quot;
					MsgBox &quot;Please enter PIN of Tenant in proper format.&quot;
		  	    End If
		     End If
		End If
		
	&apos;***	
	  	protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;A&quot;,&quot;aPinOfTenantListW2_Listener_&quot;,aPinOfTenantListW2_Listener,aPinOfTenantListW2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on County
&apos;A_Basic_Info - Part2
&apos;Case : Wife
&apos;*************************************
sub aCountyListW2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aCountyListW2_Listener,aCountyListW2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;G&quot;,&quot;aCountyListW2_Listener_&quot;,aCountyListW2_Listener,aCountyListW2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;G&quot;&amp;(startRowNum+1)&amp;&quot;:G&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;CountyName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(15,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;R&quot;&amp;(row+1)&amp;&quot;:R&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(14,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;R&quot;&amp;(row+1)&amp;&quot;:R&quot;&amp;(row+1)).string=&quot;&quot;
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=&quot;&quot;
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	     
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string=&quot;&quot;
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;G&quot;,&quot;aCountyListW2_Listener_&quot;,aCountyListW2_Listener,aCountyListW2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on District
&apos;A_Basic_Info - Part2
&apos;Case : Wife
&apos;*************************************
sub aDistrictListW2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDistrictListW2_Listener,aDistrictListW2)
	
	&apos;code
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;H&quot;,&quot;aDistrictListW2_Listener_&quot;,aDistrictListW2_Listener,aDistrictListW2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;H&quot;&amp;(startRowNum+1)&amp;&quot;:H&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;districtName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(27,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(26,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;T&quot;&amp;(row+1)&amp;&quot;:T&quot;&amp;(row+1)).string=&quot;&quot;
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	     ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string=&quot;&quot;
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;H&quot;,&quot;aDistrictListW2_Listener_&quot;,aDistrictListW2_Listener,aDistrictListW2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Business Locality
&apos;A_Basic_Info - Part2
&apos;Case : Wife
&apos;*************************************
sub aBusinessLocalityListW2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aBusinessLocalityListW2_Listener,aBusinessLocalityListW2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;I&quot;,&quot;aBusinessLocalityListW2_Listener_&quot;,aBusinessLocalityListW2_Listener,aBusinessLocalityListW2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;I&quot;&amp;(startRowNum+1)&amp;&quot;:I&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;localityName&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(31,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=Cstr(sheet.getCellByPosition(30,i).value)
				            	Exit for
				         	End If
					     End If
			    Next i
		    Else
		    	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;U&quot;&amp;(row+1)&amp;&quot;:U&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;) 
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;I&quot;,&quot;aBusinessLocalityListW2_Listener_&quot;,aBusinessLocalityListW2_Listener,aBusinessLocalityListW2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Town
&apos;A_Basic_Info - Part2
&apos;Case : Wife
&apos;*************************************
sub aTownListW2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aTownListW2_Listener,aTownListW2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;L&quot;,&quot;aTownListW2_Listener_&quot;,aTownListW2_Listener,aTownListW2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;L&quot;&amp;(startRowNum+1)&amp;&quot;:L&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;Town&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(13,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
				            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;M&quot;&amp;(row+1)&amp;&quot;:M&quot;&amp;(row+1)).string=sheet.getCellByPosition(12,i).string
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;M&quot;&amp;(row+1)&amp;&quot;:M&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;L&quot;,&quot;aTownListW2_Listener_&quot;,aTownListW2_Listener,aTownListW2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;================================================
&apos;Added By Sandeep Thaker(671333)
&apos;================================================
sub aPostalCodeListW2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aPostalCodeListW2_Listener,aPostalCodeListW2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentPaid.RentListW&quot;,&quot;M&quot;,&quot;aPostalCodeListW2_Listener_&quot;,aPostalCodeListW2_Listener,aPostalCodeListW2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    
	    sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	    sheet.Unprotect(Pwd)
	    Dim dateFlag as Boolean
	    Dim msgStr As string
	
	  	oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = sheet.getCellrangeByName(&quot;M&quot;&amp;(startRowNum+1)&amp;&quot;:M&quot;&amp;(endRowNum+1))
		startRowNum = oColRange.getRangeAddress().StartRow
	    endRowNum = oColRange.getRangeAddress().EndRow
	
		unprotectsheet(&quot;A_Basic_Info&quot;)
		Dim value As String 
		Dim county As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			value= currRange.string
			row= currRange.getCellAddress().Row 
			sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
			sheet.Unprotect(Pwd)
			oRange = ThisComponent.NamedRanges.getByName(&quot;PostalCode&quot;)
		    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
		    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		    
			if value&lt;&gt;&quot;&quot; then	
				sheet=ThisComponent.sheets.getByName(&quot;Data&quot;)
				for i=startRowNum to endRowNum
				 county=sheet.getCellByPosition(12,i).string
				         If county&lt;&gt;&quot;&quot; then
				            If county = value then
			            	ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;L&quot;&amp;(row+1)&amp;&quot;:L&quot;&amp;(row+1)).string=sheet.getCellByPosition(13,i).string
				            	Exit for
				         	End If
					     End If
			    Next i
			Else
				ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;L&quot;&amp;(row+1)&amp;&quot;:L&quot;&amp;(row+1)).string=&quot;&quot;
		    End If      
	     End If
	   	
	   	protectsheet(&quot;A_Basic_Info&quot;) 
	   	protectsheet(&quot;Data&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;M&quot;,&quot;aPostalCodeListW2_Listener_&quot;,aPostalCodeListW2_Listener,aPostalCodeListW2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
&apos;==============================================================
&apos;End Of Added By Sandeep Thaker(671333)
&apos;==============================================================
&apos;*************************************
&apos;Check on Date From
&apos;A_Basic_Info - Part2
&apos;Case : Wife
&apos;*************************************
sub aDateFromListW2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDateFromListW2_Listener,aDateFromListW2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;N&quot;,&quot;aDateFromListW2_Listener_&quot;,aDateFromListW2_Listener,aDateFromListW2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		Dim endDate as String
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;N&quot;&amp;(startRowNum+1)&amp;&quot;:N&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateFrom As String
		Dim dateTo As String
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateFrom= currRange.string
			row= currRange.getCellAddress().Row 
			dateTo= oSheet.getCellrangeByName(&quot;O&quot; &amp; (row+1)  &amp; &quot;:O&quot; &amp; (row+1)).string 
	         If dateFrom&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateFrom) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateFrom)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date From in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateTo&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date From in Row &quot; &amp; (row+1) &amp; &quot; should be same as or before Date To &quot;
	                End If
	             End If
	         End If
		End If
	&apos;***	
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;N&quot;,&quot;aDateFromListW2_Listener_&quot;,aDateFromListW2_Listener,aDateFromListW2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Date To
&apos;A_Basic_Info - Part2
&apos;Case : Wife
&apos;*************************************
sub aDateToListW2_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(aDateToListW2_Listener,aDateToListW2)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;O&quot;,&quot;aDateToListW2_Listener_&quot;,aDateToListW2_Listener,aDateToListW2)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
		Dim endDate as String
	    oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		oColRange = sheet.getCellrangeByName(&quot;O&quot;&amp;(startRowNum+1)&amp;&quot;:O&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateFrom As String
		Dim dateTo As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateTo= currRange.string
			row= currRange.getCellAddress().Row 
			dateFrom= oSheet.getCellrangeByName(&quot;N&quot; &amp; (row+1)  &amp; &quot;:N&quot; &amp; (row+1)).string 
	         If dateTo&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateTo) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateTo)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date To in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateFrom&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date To in Row &quot; &amp; (row+1) &amp; &quot; should be same as or after Date From &quot;
	                End If
	            End If
	         End If
		End If
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;RentalIncome.ListW&quot;,&quot;O&quot;,&quot;aDateToListW2_Listener_&quot;,aDateToListW2_Listener,aDateToListW2)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Subroutine for toggling Spouse fields on basis of Yes/No.
&apos;*************************************
sub toggleSpouseFields(lockCell As Boolean)
		Call RemoveAllListener()
	Dim startRowNum As Long,endRowNum As Long,i As Long
	Dim oRange As Object,currentSheet As Object

		for i=0 to ThisComponent.Sheets.Count - 1
			ActiveSheet = ThisComponent.sheets.getByIndex(i)
			&apos;msgbox ActiveSheet.name	
			ActiveSheet.unprotect(Pwd)
		next i
		
 		Call lockUnlock_cell_rng(&quot;A_Basic_Info&quot;, &quot;RetInf.SpousePIN&quot;, lockCell)
 		Call lockUnlock_cell_rng(&quot;A_Basic_Info&quot;, &quot;RetInf.DeclareWifeBusIncome&quot;, lockCell)
	 	Call lockUnlock_cell_rng(&quot;A_Basic_Info&quot;, &quot;RetInf.DeclareWifeExemptionCerti&quot;, lockCell) 
 		Call lockUnlock_cell_rng(&quot;A_Basic_Info&quot;, &quot;audit.PINOfAuditorW&quot;, lockCell)
 		Call lockUnlock_cell_rng(&quot;A_Basic_Info&quot;, &quot;audit.NameOfAuditorW&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;A_Basic_Info&quot;, &quot;audit.DateOfAuditCertiW&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;T_Tax_Computation&quot;, &quot;TaxComp.WithHoldingListWTO&quot;, lockCell)	 
		Call lockUnlock_cell_rng(&quot;T_Tax_Computation&quot;, &quot;TaxComp.VehicleAdvTaxPaidListWTO&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;T_Tax_Computation&quot;, &quot;TaxComp.MRIWTO&quot;, lockCell)
		
		Call lockUnlock_cell_rng(&quot;P_Advance_Tax_Credits&quot;, &quot;$D$3&quot;, True)
		Call lockUnlock_cell_rng(&quot;P_Advance_Tax_Credits&quot;, &quot;$D$4&quot;, True)
		Call lockUnlock_cell_rng(&quot;P_Advance_Tax_Credits&quot;, &quot;$E$3&quot;, True)
		Call lockUnlock_cell_rng(&quot;P_Advance_Tax_Credits&quot;, &quot;$E$4&quot;, True)
		Call lockUnlock_cell_rng(&quot;P_Advance_Tax_Credits&quot;, &quot;$D$11&quot;, True)
		Call lockUnlock_cell_rng(&quot;P_Advance_Tax_Credits&quot;, &quot;$D$12&quot;, True)
		Call lockUnlock_cell_rng(&quot;P_Advance_Tax_Credits&quot;, &quot;$E$11&quot;, True)
		Call lockUnlock_cell_rng(&quot;P_Advance_Tax_Credits&quot;, &quot;$E$12&quot;, True)
		oRange = ThisComponent.NamedRanges.getByName(&quot;RentPaid.RentListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;A_Basic_Info&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:P&quot; &amp; (endRowNum+1),lockCell)
		
		Call clearContentFromProtectedFields(&quot;A_Basic_Info&quot;, &quot;R&quot; &amp; (startRowNum+1) &amp; &quot;:R&quot; &amp; (endRowNum+1))
		Call clearContentFromProtectedFields(&quot;A_Basic_Info&quot;, &quot;T&quot; &amp; (startRowNum+1) &amp; &quot;:T&quot; &amp; (endRowNum+1))
		Call clearContentFromProtectedFields(&quot;A_Basic_Info&quot;, &quot;U&quot; &amp; (startRowNum+1) &amp; &quot;:U&quot; &amp; (endRowNum+1))
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;RentalIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;A_Basic_Info&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:P&quot; &amp; (endRowNum+1),lockCell)
		
		Call clearContentFromProtectedFields(&quot;A_Basic_Info&quot;, &quot;R&quot; &amp; (startRowNum+1) &amp; &quot;:R&quot; &amp; (endRowNum+1))
		Call clearContentFromProtectedFields(&quot;A_Basic_Info&quot;, &quot;T&quot; &amp; (startRowNum+1) &amp; &quot;:T&quot; &amp; (endRowNum+1))
		Call clearContentFromProtectedFields(&quot;A_Basic_Info&quot;, &quot;U&quot; &amp; (startRowNum+1) &amp; &quot;:U&quot; &amp; (endRowNum+1))
		
		&apos;Section B Wife
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C4:H5&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C9:H11&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C14:H15&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C18:H19&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C22:H27&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C30:H32&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C37:H46&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C50:H76&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;D77:D77&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C80:H83&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C86:H94&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;C97:H102&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;I108:I108&quot;, lockCell)
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;PLA.OtherExpensesListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
	    oRange = ThisComponent.NamedRanges.getByName(&quot;PLA.OtherIncomeListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;B_Profit_Loss_Account_Wife&quot;, &quot;B&quot; &amp; (startRowNum+1) &amp; &quot;:H&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;C_Balance_Sheet
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D5:D11&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D14:D18&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D23:D26&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D29:D31&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D34:D35&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D37:D37&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D40:D43&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D45:D45&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D49:D53&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D56:D58&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D63:D68&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D72:D75&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D78:D81&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;C_Balance_Sheet&quot;, &quot;D83:D83&quot;, lockCell)
		
		&apos;D_Stock_Analysis
		oRange = ThisComponent.NamedRanges.getByName(&quot;Inv.QuantDtlsListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;D_Stock_Analysis&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:F&quot; &amp; (endRowNum+1),lockCell)
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;Inv.QuantDtlsListKIIW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;D_Stock_Analysis&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:I&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;E1_IDA_CA
		oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllPlanMach.ListPart1W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;E1_IDA_CA&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:H&quot; &amp; (endRowNum+1),lockCell)
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;E1_IDA_CA&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:B&quot; &amp; (endRowNum+1),lockCell)
		Call lockUnlock_cell_rng(&quot;E1_IDA_CA&quot;, &quot;D&quot; &amp; (startRowNum+1) &amp; &quot;:E&quot; &amp; (endRowNum+1),lockCell)
		Call lockUnlock_cell_rng(&quot;E1_IDA_CA&quot;, &quot;G&quot; &amp; (startRowNum+1) &amp; &quot;:H&quot; &amp; (endRowNum+1),lockCell)
		
		Call clearContentFromProtectedFields(&quot;E1_IDA_CA&quot;, &quot;C&quot; &amp; (startRowNum+1) &amp; &quot;:C&quot; &amp; (endRowNum+1))
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;AgrLandDed.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;E1_IDA_CA&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:F&quot; &amp; (endRowNum+1),lockCell)

		oRange = ThisComponent.NamedRanges.getByName(&quot;DeprIntengAst.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;E1_IDA_CA&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:D&quot; &amp; (endRowNum+1),lockCell)
		Call lockUnlock_cell_rng(&quot;E1_IDA_CA&quot;, &quot;F&quot; &amp; (startRowNum+1) &amp; &quot;:G&quot; &amp; (endRowNum+1),lockCell)
		
		Call clearContentFromProtectedFields(&quot;E1_IDA_CA&quot;, &quot;E&quot; &amp; (startRowNum+1) &amp; &quot;:E&quot; &amp; (endRowNum+1))
		
		&apos;E2_CA_WTA_WDV
		Call lockUnlock_cell_rng(&quot;E2_CA_WTA_WDV&quot;, &quot;B16:E18&quot;, lockCell)
		
		&apos;E2_CA_WTA_SLM
		oRange = ThisComponent.NamedRanges.getByName(&quot;WAT.ListBW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;E2_CA_WTA_SLM&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:G&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;F_Employment_Income
		oRange = ThisComponent.NamedRanges.getByName(&quot;EmpIncome.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;F_Employment_Income&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:D&quot; &amp; (endRowNum+1),lockCell)
		Call lockUnlock_cell_rng(&quot;F_Employment_Income&quot;, &quot;F&quot; &amp; (startRowNum+1) &amp; &quot;:G&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;G_Partnership_Income
		oRange = ThisComponent.NamedRanges.getByName(&quot;ProfitShare.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;G_Partnership_Income&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:H&quot; &amp; (endRowNum+1),lockCell)
		
		Call clearContentFromProtectedFields(&quot;G_Partnership_Income&quot;, &quot;K&quot; &amp; (startRowNum+1) &amp; &quot;:K&quot; &amp; (endRowNum+1))
		
		&apos;H_Estate_Trust_Income
		oRange = ThisComponent.NamedRanges.getByName(&quot;EstateTrust.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;H_Estate_Trust_Income&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:D&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;I_Computation_of_Car_Benefit
		oRange = ThisComponent.NamedRanges.getByName(&quot;CarBenefit.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;I_Computation_of_Car_Benefit&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:F&quot; &amp; (endRowNum+1),lockCell)
		Call lockUnlock_cell_rng(&quot;I_Computation_of_Car_Benefit&quot;, &quot;H&quot; &amp; (startRowNum+1) &amp; &quot;:I&quot; &amp; (endRowNum+1),lockCell)
		
		Call clearContentFromProtectedFields(&quot;I_Computation_of_Car_Benefit&quot;, &quot;G&quot; &amp; (startRowNum+1) &amp; &quot;:H&quot; &amp; (endRowNum+1))
		Call clearContentFromProtectedFields(&quot;I_Computation_of_Car_Benefit&quot;, &quot;L&quot; &amp; (startRowNum+1) &amp; &quot;:M&quot; &amp; (endRowNum+1))
		
		
		&apos;J_Computation_of_Mortgage
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;MortgageIntDtls.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;J_Computation_of_Mortgage&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:F&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;K_Home_Ownership_Saving_Plan
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;HomeOwnershipSavingPlan.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;K_Home_Ownership_Saving_Plan&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:D&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;L_Computation_of_Insu_Relief
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;InsReliefDtls.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;L_Computation_of_Insu_Relief&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:E&quot; &amp; (endRowNum+1),lockCell)
		Call lockUnlock_cell_rng(&quot;L_Computation_of_Insu_Relief&quot;, &quot;G&quot; &amp; (startRowNum+1) &amp; &quot;:J&quot; &amp; (endRowNum+1),lockCell)
		
		Call clearContentFromProtectedFields(&quot;L_Computation_of_Insu_Relief&quot;, &quot;F&quot; &amp; (startRowNum+1) &amp; &quot;:F&quot; &amp; (endRowNum+1))
		
		&apos;M_Details_of_PAYE_Deducted
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;PayeDed.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;M_Details_of_PAYE_Deducted&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:E&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;N_Installment_Tax_Credits
		oRange = ThisComponent.NamedRanges.getByName(&quot;InstallmentTax.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;N_Installment_Tax_Credits&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:C&quot; &amp; (endRowNum+1),lockCell)
		
	
		
		&apos;Q_IT_Payment_Credits
		oRange = ThisComponent.NamedRanges.getByName(&quot;DtlIncomePaid.IncomePaidAdvanceListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;Q_IT_Payment_Credits&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:C&quot; &amp; (endRowNum+1),lockCell)
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;DtlIncomePaid.IncomePaidSelfAssmntListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;Q_IT_Payment_Credits&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:C&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;R_DTAA_Credits
		oRange = ThisComponent.NamedRanges.getByName(&quot;DTAACredits.DetailsW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;R_DTAA_Credits&quot;, &quot;A&quot; &amp; (startRowNum+1) &amp; &quot;:D&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;T_Income_Computation_Wife
		Call lockUnlock_cell_rng(&quot;T_Income_Computation_Wife&quot;, &quot;C4:H4&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;T_Income_Computation_Wife&quot;, &quot;C9:H10&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;T_Income_Computation_Wife&quot;, &quot;C12:H13&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;T_Income_Computation_Wife&quot;, &quot;C17:H19&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;T_Income_Computation_Wife&quot;, &quot;C25:H26&quot;, lockCell)
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;TaxComp.OthExpListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;T_Income_Computation_Wife&quot;, &quot;B&quot; &amp; (startRowNum+1) &amp; &quot;:H&quot; &amp; (endRowNum+1),lockCell)
		
		oRange = ThisComponent.NamedRanges.getByName(&quot;TaxComp.OthDedListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
	    
		Call lockUnlock_cell_rng(&quot;T_Income_Computation_Wife&quot;, &quot;B&quot; &amp; (startRowNum+1) &amp; &quot;:H&quot; &amp; (endRowNum+1),lockCell)
		
		&apos;T_Tax_Computation
		Call lockUnlock_cell_rng(&quot;T_Tax_Computation&quot;, &quot;DedDtl.PensionW&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;T_Tax_Computation&quot;, &quot;TaxComp.PersonalReliefW&quot;, lockCell)
		
		&apos;S_Previous_Years_Losses
		Call lockUnlock_cell_rng(&quot;S_Previous_Years_Losses&quot;, &quot;C18:H21&quot;, lockCell)
		Call lockUnlock_cell_rng(&quot;S_Previous_Years_Losses&quot;, &quot;C23:H23&quot;, lockCell)
		
		ThisComponent.CurrentController.Select(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.DeclareWifeIncome&quot;))
		
        for i=0 to ThisComponent.Sheets.Count - 1
			ActiveSheet = ThisComponent.sheets.getByIndex(i)		
			ActiveSheet.protect (Pwd)
		next i
		call AddListener()
		call removeKRAListners(chkWifeIncomeChoice_Listener,chkWifeIncomeChoice)
End Sub

&apos;*************************************
&apos;Function for obtaining the total atax payable - used in Formulabar.
&apos;*************************************
Function GETTOTALTAXPAYBLE(ByVal TotalTaxableIncome As Double,ByVal RtnYear As Integer ) As Double

Dim taxPayble As Double
 Dim taxPayble1 As Double
 Dim taxPayble2 As Double
 Dim taxPayble3 As Double
 Dim taxPayble4 As Double
 Dim taxPayble5 As Double
 taxPayble1 = 0
 taxPayble2 = 0
 taxPayble3 = 0
 taxPayble4 = 0
 taxPayble5 = 0
 taxPayble = 0
 If TotalTaxableIncome &lt; 0 Then
     taxPayble = 0
 Else
 If (RtnYear &lt;= 2016) Then
     If TotalTaxableIncome &gt; 466704 Then
         taxPayble1 = (TotalTaxableIncome - 466704) * 30 / 100
         taxPayble2 = (466704 - 351793) + 1
         taxPayble2 = taxPayble2 * 25 / 100
         taxPayble3 = (351792 - 236881) + 1
         taxPayble3 = taxPayble3 * 20 / 100
         taxPayble4 = (236880 - 121969) + 1
         taxPayble4 = taxPayble4 * 15 / 100
         taxPayble5 = 121968 * 10 / 100
     End If
     If TotalTaxableIncome &gt; 351792 And TotalTaxableIncome &lt; 466705 Then
         taxPayble1 = (TotalTaxableIncome - 351792) * 25 / 100
         taxPayble2 = (351792 - 236881) + 1
         taxPayble2 = taxPayble2 * 20 / 100
         taxPayble3 = (236880 - 121969) + 1
         taxPayble3 = taxPayble3 * 15 / 100
         taxPayble4 = 121968 * 10 / 100
     End If
     If TotalTaxableIncome &gt; 236880 And TotalTaxableIncome &lt; 351793 Then
         taxPayble1 = (TotalTaxableIncome - 236881 + 1) * 20 / 100
         taxPayble2 = (236880 - 121969) + 1
         taxPayble2 = taxPayble2 * 15 / 100
         taxPayble3 = 121968 * 10 / 100
     End If
     If TotalTaxableIncome &gt; 121968 And TotalTaxableIncome &lt; 236881 Then
         taxPayble1 = (TotalTaxableIncome - 121969 + 1) * 15 / 100
         taxPayble2 = 121968 * 10 / 100
     End If
     If TotalTaxableIncome &gt; 0 And TotalTaxableIncome &lt; 121969 Then
         taxPayble1 = TotalTaxableIncome * 10 / 100
     End If
     taxPayble = taxPayble1 + taxPayble2 + taxPayble3 + taxPayble4 + taxPayble5
     End If
    If (RtnYear = 2017) Then
		If TotalTaxableIncome &gt; 513373 Then
		taxPayble1 = (TotalTaxableIncome - 513373) * 30 / 100
		taxPayble2 = ((513373 - 386971) + 1)
		taxPayble2 = taxPayble2 * 25 / 100
		taxPayble3 = ((386970 - 260568) + 1)
		taxPayble3 = taxPayble3 * 20 / 100
		taxPayble4 = ((260567 - 134165) + 1)
		taxPayble4 = taxPayble4 * 15 / 100
		taxPayble5 = 1341640 / 100
		End If
		If TotalTaxableIncome &gt;= 386971 And TotalTaxableIncome &lt;= 513373 Then
		taxPayble1 = (TotalTaxableIncome - 386970) * 25 / 100
		taxPayble2 = ((386970 - 260568) + 1)
		taxPayble2 = taxPayble2 * 20 / 100
		taxPayble3 = ((260567 - 134165) + 1)
		taxPayble3 = taxPayble3 * 15 / 100
		taxPayble4 = 1341640 / 100
		End If
		If TotalTaxableIncome &gt;= 260568 And TotalTaxableIncome &lt;= 386970 Then
		taxPayble1 = (TotalTaxableIncome - 260567) * 20 / 100
		taxPayble2 = ((260567 - 134165) + 1)
		taxPayble2 = taxPayble2 * 15 / 100
		taxPayble3 = 1341640 / 100
		End If
		If TotalTaxableIncome &gt;= 134165 And TotalTaxableIncome &lt;= 260567 Then
		taxPayble1 = (TotalTaxableIncome - 134164) * 15 / 100
		taxPayble2 = 1341640 / 100
		End If
		If TotalTaxableIncome &gt;= 0 And TotalTaxableIncome &lt;= 134164 Then
		taxPayble1 = TotalTaxableIncome / 10
		End If
		taxPayble = taxPayble1 + taxPayble2 + taxPayble3 + taxPayble4 + taxPayble5
	End If  
	If (RtnYear &gt;= 2018) Then
        If TotalTaxableIncome &gt; 564709 Then
            taxPayble1 = (TotalTaxableIncome - 564709) * 30 / 100
            taxPayble2 = ((564709 - 425667) + 1)
            taxPayble2 = taxPayble2 * 25 / 100
            taxPayble3 = ((425666 - 286624) + 1)
            taxPayble3 = taxPayble3 * 20 / 100
            taxPayble4 = ((286623 - 147581) + 1)
            taxPayble4 = taxPayble4 * 15 / 100
            taxPayble5 = 1475800 / 100
        End If
        If TotalTaxableIncome &gt;= 425667 And TotalTaxableIncome &lt;= 564709 Then
            taxPayble1 = (TotalTaxableIncome - 425666) * 25 / 100
            taxPayble2 = ((425666 - 286624) + 1)
            taxPayble2 = taxPayble2 * 20 / 100
            taxPayble3 = ((286623 - 147581) + 1)
            taxPayble3 = taxPayble3 * 15 / 100
            taxPayble4 = 1475800 / 100
        End If
        If TotalTaxableIncome &gt;= 286624 And TotalTaxableIncome &lt;= 425666 Then
            taxPayble1 = (TotalTaxableIncome - 286623) * 20 / 100
            taxPayble2 = ((286623 - 147581) + 1)
            taxPayble2 = taxPayble2 * 15 / 100
            taxPayble3 = 1475800 / 100
        End If
        If TotalTaxableIncome &gt;= 147581 And TotalTaxableIncome &lt;= 286623 Then
            taxPayble1 = (TotalTaxableIncome - 147580) * 15 / 100
            taxPayble2 = 1475800 / 100
        End If
        If TotalTaxableIncome &gt;= 0 And TotalTaxableIncome &lt;= 147580 Then
            taxPayble1 = TotalTaxableIncome / 10
        End If
        taxPayble = taxPayble1 + taxPayble2 + taxPayble3 + taxPayble4 + taxPayble5
    End If
 End If
 getTotalTaxPayble = taxPayble
 End Function
 

&apos;*******************************************
&apos; Exemption Certificate Number Self
&apos;*******************************************
sub chkDeclareExemptionCertiS_Listener_modified(oEv)
	
	if (notCallListener) then  
		exit Sub  
	end if 

	call removeKRAListners(chkExemtionCertiNoS_Listener,chkExemtionCertiNoS)
	call removeKRAListners(chkExemtionCertiDateFromS_Listener,chkExemtionCertiDateFromS)
	call removeKRAListners(chkExemtionCertiDateToS_Listener,chkExemtionCertiDateToS)
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoS_Listener_&quot;,chkExemtionCertiNoS_Listener,chkExemtionCertiNoS)
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromS_Listener_&quot;,chkExemtionCertiDateFromS_Listener,chkExemtionCertiDateFromS)
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToS_Listener_&quot;,chkExemtionCertiDateToS_Listener,chkExemtionCertiDateToS)
  		thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	
	Unprotectsheet(&quot;A_Basic_Info&quot;)
	&apos;*******************************
	Dim sheet as Object
		Dim msgStr As String
		Dim DeclareExemptionCertiS as String
		
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		DeclareExemptionCertiS= sheet.getCellrangeByName(&quot;RetInf.DeclareExemptionCerti&quot;).string
		
		If (DeclareExemptionCertiS=&quot;Yes&quot;) Then
			Unprotect_Range(&quot;A_Basic_Info&quot;,&quot;ExemptCertiS&quot;)
		ElseIf (DeclareExemptionCertiS=&quot;No&quot;) Then
			Protect_Range(&quot;A_Basic_Info&quot;,&quot;ExemptCertiS&quot;)
		Else
			Protect_Range(&quot;A_Basic_Info&quot;,&quot;ExemptCertiS&quot;)
		End If
	  	protectsheet(&quot;A_Basic_Info&quot;)
	&apos;code
	
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoS_Listener_&quot;,chkExemtionCertiNoS_Listener,chkExemtionCertiNoS)
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromS_Listener_&quot;,chkExemtionCertiDateFromS_Listener,chkExemtionCertiDateFromS)
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToS_Listener_&quot;,chkExemtionCertiDateToS_Listener,chkExemtionCertiDateToS)

    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
End sub
&apos;*******************************************
&apos; End of Exemption Certificate Number Self
&apos;*******************************************



&apos;*******************************************
&apos; Exemption Certificate Number Wife
&apos;*******************************************
sub chkDeclareExemptionCertiW_Listener_modified(oEv)

	if (notCallListener) then  
		exit Sub  
	end if 
	call removeKRAListners(chkExemtionCertiNoW_Listener,chkExemtionCertiNoW)
	call removeKRAListners(chkExemtionCertiDateFromW_Listener,chkExemtionCertiDateFromW)
	call removeKRAListners(chkExemtionCertiDateToW_Listener,chkExemtionCertiDateToW)
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoW_Listener_&quot;,chkExemtionCertiNoW_Listener,chkExemtionCertiNoW)
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromW_Listener_&quot;,chkExemtionCertiDateFromW_Listener,chkExemtionCertiDateFromW)
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToW_Listener_&quot;,chkExemtionCertiDateToW_Listener,chkExemtionCertiDateToW)

	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************

		Unprotectsheet(&quot;A_Basic_Info&quot;)
		
		Dim sheet as Object
		Dim msgStr As String
		Dim DeclareExemptionCertiS as String
	
		sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
		DeclareExemptionCertiW= sheet.getCellrangeByName(&quot;RetInf.DeclareWifeExemptionCerti&quot;).string
		
		If (DeclareExemptionCertiW=&quot;Yes&quot;) Then
			Unprotect_Range(&quot;A_Basic_Info&quot;,&quot;ExemptCertiW&quot;)
		ElseIf (DeclareExemptionCertiW=&quot;No&quot;) Then
			Protect_Range(&quot;A_Basic_Info&quot;,&quot;ExemptCertiW&quot;)
		Else
			Protect_Range(&quot;A_Basic_Info&quot;,&quot;ExemptCertiW&quot;)
		End If
	  	protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoW_Listener_&quot;,chkExemtionCertiNoW_Listener,chkExemtionCertiNoW)
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromW_Listener_&quot;,chkExemtionCertiDateFromW_Listener,chkExemtionCertiDateFromW)
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToW_Listener_&quot;,chkExemtionCertiDateToW_Listener,chkExemtionCertiDateToW)
	
   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
&apos;*******************************************
&apos; End of  Exemption Certificate Number Wife
&apos;*******************************************


&apos;**********************************************
&apos; Check on From Date of exemption Certificate Number
&apos;A_Basic_Info - Part6
&apos;Case:Self
&apos;**********************************************

Sub chkExemtionCertiDateFromS_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkExemtionCertiDateFromS_Listener,chkExemtionCertiDateFromS)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromS_Listener_&quot;,chkExemtionCertiDateFromS_Listener,chkExemtionCertiDateFromS)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		Dim endDate as String
		Dim startDate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;ExemptCerti.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = oSheet.getCellrangeByName(&quot;B&quot;&amp;(startRowNum+1)&amp;&quot;:B&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateVal As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateFrom= currRange.string
			row= currRange.getCellAddress().Row 
			dateTo= oSheet.getCellrangeByName(&quot;C&quot; &amp; (row+1)  &amp; &quot;:C&quot; &amp; (row+1)).string 
	         If dateFrom&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateFrom) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateFrom)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date From in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateTo&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date From in Row &quot; &amp; (row+1) &amp; &quot; should be same as or before Date To &quot;
	                ElseIf dateFrom&lt;&gt;&quot;&quot; Then
	                	dtFrom = Split(dateFrom,&quot;/&quot;)
	                	If(dtFrom(0)&lt;&gt;&quot;01&quot;) Then
	                		MsgBox &quot;Date From should start with starting of month&quot;
	                		currRange.string=&quot;&quot;
	                	End If 
	                	
	                	If(dateFrom&lt;&gt;&quot;&quot;) Then        	
	                		startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	   						endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
							dtFrom = Split(dateFrom,&quot;/&quot;)
							unprotectsheet(&quot;A_Basic_Info&quot;)
							currRange = ThisComponent.getCurrentSelection() 
							If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then 		
									for i=startRowNum to endRowNum
										
										prevToMonth = oSheet.getCellByPosition(5,i).string
										prevFromMonth = oSheet.getCellByPosition(6,i).string
										If(dtFrom(1)&gt;prevFromMonth AND dtFrom(1)&lt;prevToMonth) Then
											MsgBox &quot;You have already entered the period in &quot; &amp; (row)
	                						currRange.string=&quot;&quot;
										End If 
								 
				          			Next 
				          		     	
				         	 End If 
				         End If 
	              	  End If
	             End If
	         End If
		End If
	   	Protectsheet(&quot;A_Basic_Info&quot;)	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromS_Listener_&quot;,chkExemtionCertiDateFromS_Listener,chkExemtionCertiDateFromS)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
End Sub

&apos;**********************************************
&apos; Check on From Date of exemption Certificate Number
&apos;A_Basic_Info - Part6
&apos;Case:Wife
&apos;**********************************************

Sub chkExemtionCertiDateFromW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkExemtionCertiDateFromW_Listener,chkExemtionCertiDateFromW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromW_Listener_&quot;,chkExemtionCertiDateFromW_Listener,chkExemtionCertiDateFromW)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		Dim endDate as String
		Dim startDate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;ExemptCerti.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = oSheet.getCellrangeByName(&quot;B&quot;&amp;(startRowNum+1)&amp;&quot;:B&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateVal As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateFrom= currRange.string
			row= currRange.getCellAddress().Row 
			dateTo= oSheet.getCellrangeByName(&quot;C&quot; &amp; (row+1)  &amp; &quot;:C&quot; &amp; (row+1)).string 
	         If dateFrom&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateFrom) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateFrom)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date From in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateTo&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date From in Row &quot; &amp; (row+1) &amp; &quot; should be same as or before Date To &quot;
	                ElseIf dateFrom&lt;&gt;&quot;&quot; Then
	                	dtFrom = Split(dateFrom,&quot;/&quot;)
	                	If(dtFrom(0)&lt;&gt;&quot;01&quot;) Then
	                		MsgBox &quot;Date From should start with starting of month&quot;
	                		currRange.string=&quot;&quot;
	                	End If 
	               
	                End If
	             End If
	         End If
		End If
	   	Protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;B&quot;,&quot;chkExemtionCertiDateFromW_Listener_&quot;,chkExemtionCertiDateFromW_Listener,chkExemtionCertiDateFromW)
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
End Sub

&apos;**********************************************
&apos; Check on To Date of exemption Certificate Number
&apos;A_Basic_Info - Part6
&apos;Case:Self
&apos;**********************************************

Sub chkExemtionCertiDateToS_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if  
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkExemtionCertiDateToS_Listener,chkExemtionCertiDateToS)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToS_Listener_&quot;,chkExemtionCertiDateToS_Listener,chkExemtionCertiDateToS)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		Dim endDate as String
		Dim startDate as String
		Dim dateTo As String
		Dim dateFrom As String 

	    oRange = ThisComponent.NamedRanges.getByName(&quot;ExemptCerti.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = oSheet.getCellrangeByName(&quot;C&quot;&amp;(startRowNum+1)&amp;&quot;:C&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =  ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateVal As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateTo= currRange.string
			row= currRange.getCellAddress().Row 
			dateFrom= oSheet.getCellrangeByName(&quot;B&quot; &amp; (row+1)  &amp; &quot;:B&quot; &amp; (row+1)).string 
	         If dateTo&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateTo) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateTo)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   dateTo = &quot;&quot;
			        		   MsgBox &quot;Date To in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateFrom&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date To in Row &quot; &amp; (row+1) &amp; &quot; should be same as or after Date From &quot;
	                		dateTo=&quot;&quot;
	                ElseIf dateTo&lt;&gt;&quot;&quot; Then
	                	dtTo = Split(dateTo,&quot;/&quot;)
	                	flag=false
	                		Select Case (dtTo(0))
								Case &quot;28&quot;
									If(dtTo(1)=&quot;02&quot; And (TestLeapYear(dateTo)=false) And ValidateDate(dateTo)) Then
										flag=true
									End If
								case &quot;29&quot;
									If(dtTo(1)=&quot;02&quot; And (TestLeapYear(dateTo)=true) And ValidateDate(dateTo)) Then
										flag=true
									End If
								case &quot;30&quot;
									If(TestEvenMonth(dateTo) And ValidateDate(dateTo)) Then
										flag=true
									End If
								case &quot;31&quot;
									If(TestOddMonth(dateTo) And ValidateDate(dateTo)) Then
										flag=true
									End If
							End select
	                		If (flag=false) Then
	 		               		MsgBox &quot;Date To should be date of end of month&quot;
	                			currRange.string=&quot;&quot;
	                			dateTo=&quot;&quot;
	                		End If 
	                	
	                		If(dateTo&lt;&gt;&quot;&quot;) Then	
	                		startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	   						endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
							dtTo = Split(dateTo,&quot;/&quot;)
							unprotectsheet(&quot;A_Basic_Info&quot;)
							currRange = ThisComponent.getCurrentSelection() 
							If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then 		
								
										for i=startRowNum to endRowNum
											If(dateTo&lt;&gt;&quot;&quot;) Then	
												prevToMonth = oSheet.getCellByPosition(5,i).string
												prevFromMonth = oSheet.getCellByPosition(6,i).string
												currFromMonth = oSheet.getCellByPosition(6,(i+1)).string
												If(dtTo(1)&gt;prevFromMonth AND dtTo(1)&lt;prevToMonth) Then
													MsgBox &quot;You have already entered the period in &quot; &amp; (row)
			                						currRange.string=&quot;&quot;
												End If 
												If(currFromMonth&lt;&gt;&quot;&quot; AND currFromMonth&lt;prevFromMonth AND dtTo(1)&gt;prevToMonth) OR (currFromMonth&lt;&gt;&quot;&quot; AND currFromMonth&lt;prevFromMonth AND dtTo(1)=prevToMonth) Then
													MsgBox &quot;You have already entered the period in &quot; &amp; (row)
			                						currRange.string=&quot;&quot;
			                						dateTo=&quot;&quot;
												End If
											End If 
									 
					          			Next 
				          	 End If  	 
				         End If
	                End If
	             End If
	         End If
	       else
		End If
		protectsheet(&quot;A_Basic_Info&quot;)	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToS_Listener_&quot;,chkExemtionCertiDateToS_Listener,chkExemtionCertiDateToS)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
End Sub

Public Function TestOddMonth(strDate As String) As Boolean

     strMonth = Split(strDate,&quot;/&quot;)
     Select Case (strMonth(1))
	    case &quot;01&quot;
	    	TestOddMonth = true
	    case &quot;03&quot;
	    	TestOddMonth = true
	    case &quot;05&quot;
	    	TestOddMonth = true
	    case &quot;07&quot;
	    	TestOddMonth = true
	    case &quot;08&quot;
	    	TestOddMonth = true
	    case &quot;10&quot;
	    	TestOddMonth = true
	    case &quot;12&quot;
    		TestOddMonth = true
    	case Else
    		TestOddMonth = False
    End Select
End Function

Public Function TestEvenMonth(strDate As String) As Boolean
    
   	 strMonth = Split(strDate,&quot;/&quot;)
     Select Case (strMonth(1))
	    case &quot;02&quot;
	    	TestEvenMonth = true
	    case &quot;04&quot;
	    	TestEvenMonth = true
	    case &quot;06&quot;
	    	TestEvenMonth = true
	    case &quot;09&quot;
	    	TestEvenMonth = true
	    case &quot;11&quot;
			TestEvenMonth = true
    	case Else
    		 TestEvenMonth = False
    End Select
End Function

Function TestLeapYear (strDate As String) As Boolean
	
	Dim enYear as Integer
	Dim yearMod as Integer
	enYear = Int((Mid(strDate, 7,4)))
	yearMod=INT(enYear / 4)
	TestLeapYear = false
	If (yearMod * 4)  = enYear then
		TestLeapYear = true
	end If
	
End Function 
    
&apos;**********************************************
&apos; Check on To Date of exemption Certificate Number
&apos;A_Basic_Info - Part6
&apos;Case:Wife
&apos;**********************************************

Sub chkExemtionCertiDateToW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if  
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkExemtionCertiDateToW_Listener,chkExemtionCertiDateToW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToW_Listener_&quot;,chkExemtionCertiDateToW_Listener,chkExemtionCertiDateToW)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
	    Dim dateFlag as Boolean
	    Dim msgStr As string
		Dim endDate as String
		Dim startDate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;ExemptCerti.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = oSheet.getCellrangeByName(&quot;C&quot;&amp;(startRowNum+1)&amp;&quot;:C&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		startDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim dateVal As String 
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			dateTo= currRange.string
			row= currRange.getCellAddress().Row 
			dateFrom= oSheet.getCellrangeByName(&quot;B&quot; &amp; (row+1)  &amp; &quot;:B&quot; &amp; (row+1)).string 
	         If dateTo&lt;&gt;&quot;&quot; then
	            If (ValidateDate(dateTo) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(dateTo)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   MsgBox &quot;Date To in Row &quot; &amp; msgStr &amp; &quot; should be within the Return Period &quot; &amp; startDate &amp; &quot; to &quot; &amp; endDate
	                ElseIf dateFrom&lt;&gt;&quot;&quot; and checkGrtrThnDate(dateFrom,dateTo)=False then
	                		currRange.string=&quot;&quot;
	                		MsgBox &quot;Date To in Row &quot; &amp; (row+1) &amp; &quot; should be same as or after Date From &quot;
	                ElseIf dateTo&lt;&gt;&quot;&quot; Then
	                	ElseIf dateTo&lt;&gt;&quot;&quot; Then
	                	dtTo = Split(dateTo,&quot;/&quot;)
	                	flag=false
	                		Select Case (dtTo(0))
								Case &quot;28&quot;
									If(dtTo(1)=&quot;02&quot;  And (TestLeapYear(dateTo)=false) And ValidateDate(dateTo)) Then
										flag=true
									End If
								case &quot;29&quot;
									If(dtTo(1)=&quot;02&quot; And (TestLeapYear(dateTo)=true) And ValidateDate(dateTo)) Then
										flag=true
									End If
								case &quot;30&quot;
									If(TestEvenMonth(dateTo) And ValidateDate(dateTo)) Then
										flag=true
									End If
								case &quot;31&quot;
									If(TestOddMonth(dateTo) And ValidateDate(dateTo)) Then
										flag=true
									End If
							End select
	                		If (flag=false) Then
	 		               		MsgBox &quot;Date To should be date of end of month&quot;
	                			currRange.string=&quot;&quot;
	                
	                	End If 
	                End If
	             End If
	         End If
	       else
		End If
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;C&quot;,&quot;chkExemtionCertiDateToW_Listener_&quot;,chkExemtionCertiDateToW_Listener,chkExemtionCertiDateToW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
End Sub

Sub chkExemtionCertiNoS_Listener_modified(oEv)
	If (notCallListener) then  
		exit Sub  
	end if 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkExemtionCertiNoS_Listener,chkExemtionCertiNoS)
		
	&apos;Code
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoS_Listener_&quot;,chkExemtionCertiNoS_Listener,chkExemtionCertiNoS)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
		 oRange = ThisComponent.NamedRanges.getByName(&quot;ExemptCerti.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = oSheet.getCellrangeByName(&quot;A&quot;&amp;(startRowNum+1)&amp;&quot;:A&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		
		Dim exmptNo As String 
		Dim testexmptNo As String
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			exmptNo= currRange.string
			currRange.string=Ucase(exmptNo)
			row= currRange.getCellAddress().Row 
			if exmptNo&lt;&gt;&quot;&quot; then		
				for i=startRowNum to endRowNum
				
				 testexmptNo=oSheet.getCellByPosition(0,i).string
			         if row=i then &apos;Skip
			         Else
				         If testexmptNo&lt;&gt;&quot;&quot; then
				            If UCase(testexmptNo) &lt;&gt; Ucase(exmptNo) then
				            	MsgBox &quot;You have already entered details of &apos;&quot; &amp; Ucase(testexmptNo) &amp; &quot;&apos; in Row &quot; &amp; (i+1)
				            	currRange.string=&quot;&quot;
				            	Exit for
				         	End If
					     End If    
					 End If    
			    Next

			    &apos;---Wife Exemption number check---
			     oRange = ThisComponent.NamedRanges.getByName(&quot;ExemptCerti.ListW&quot;)
			    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
			    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
				oColRange = oSheet.getCellrangeByName(&quot;A&quot;&amp;(startRowNum+1)&amp;&quot;:A&quot;&amp;(endRowNum+1))
				startRowNum = oColRange.getRangeAddress().StartRow
			    endRowNum = oColRange.getRangeAddress().EndRow
	    		
	    		for i=startRowNum to endRowNum
				
				 testexmptNo=oSheet.getCellByPosition(0,i).string	
			         if row=i then &apos;Skip
			         Else
				         If testexmptNo&lt;&gt;&quot;&quot; then
				            If UCase(testexmptNo) = Ucase(exmptNo) then
				            	MsgBox &quot;You have already entered details of &apos;&quot; &amp; Ucase(testexmptNo) &amp; &quot;&apos; in Row &quot; &amp; (i+1)
				            	currRange.string=&quot;&quot;
				            	Exit for
				         	End If
					     End If    
					 End If    
			    Next
			    &apos;---Wife Exemption number check---
		    End If      
	     End If   
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListS&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoS_Listener_&quot;,chkExemtionCertiNoS_Listener,chkExemtionCertiNoS)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True

End Sub


Sub chkExemtionCertiNoW_Listener_modified(oEv)
	If (notCallListener) then  
		exit Sub  
	end if 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(chkExemtionCertiNoW_Listener,chkExemtionCertiNoW)
		
	&apos;Code
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoW_Listener_&quot;,chkExemtionCertiNoW_Listener,chkExemtionCertiNoW)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    Dim sheet as Object
		oRange = ThisComponent.NamedRanges.getByName(&quot;ExemptCerti.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		oColRange = oSheet.getCellrangeByName(&quot;A&quot;&amp;(startRowNum+1)&amp;&quot;:A&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;A_Basic_Info&quot;)
		
		Dim exmptNo As String 
		Dim testexmptNo As String
	&apos;***	
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			exmptNo= currRange.string
			currRange.string=Ucase(exmptNo)
			row= currRange.getCellAddress().Row 
			if exmptNo&lt;&gt;&quot;&quot; then		
				for i=startRowNum to endRowNum
				
				 testexmptNo=oSheet.getCellByPosition(0,i).string
			         if row=i then &apos;Skip
			         Else
				         If testexmptNo&lt;&gt;&quot;&quot; then
				            If UCase(testexmptNo) &lt;&gt; Ucase(exmptNo) then
				            	MsgBox &quot;You have already entered details of &apos;&quot; &amp; Ucase(testexmptNo) &amp; &quot;&apos; in Row &quot; &amp; (i+1)
				            	currRange.string=&quot;&quot;
				            	exmptNo=&quot;&quot;
				            	Exit for
				         	End If
					     End If    
					 End If    
			    Next
			    
			    &apos;---Wife Exemption number check---
			    oRange = ThisComponent.NamedRanges.getByName(&quot;ExemptCerti.ListS&quot;)
			    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
			    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
				oColRange = oSheet.getCellrangeByName(&quot;A&quot;&amp;(startRowNum+1)&amp;&quot;:A&quot;&amp;(endRowNum+1))
				startRowNum = oColRange.getRangeAddress().StartRow
			    endRowNum = oColRange.getRangeAddress().EndRow
	    		
	    		for i=startRowNum to endRowNum
				
				 testexmptNo=oSheet.getCellByPosition(0,i).string	
			         if row=i then &apos;Skip
			         Else
				         If testexmptNo&lt;&gt;&quot;&quot; then
				            If UCase(testexmptNo) = Ucase(exmptNo) then
				            	MsgBox &quot;You have already entered details of &apos;&quot; &amp; Ucase(exmptNo) &amp; &quot;&apos; in Row &quot; &amp; (i+1)
				            	currRange.string=&quot;&quot;
				            	Exit for
				         	End If
					     End If    
					 End If    
			    Next
			    &apos;---Wife Exemption number check---
			    
		    End If      
	     End If   
		protectsheet(&quot;A_Basic_Info&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;A_Basic_Info&quot;,&quot;ExemptCerti.ListW&quot;,&quot;A&quot;,&quot;chkExemtionCertiNoW_Listener_&quot;,chkExemtionCertiNoW_Listener,chkExemtionCertiNoW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
End Sub
&apos;Added by vaishali gohil
sub DeclareSelfBusIncome_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(DeclareSelfBusIncome_Listener,DeclareSelfBusIncome)
	
	&apos;code
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	
	if  oSheet.name = &quot;Amendment&quot; then
		&apos;call addKRAListnersSingleCell(&quot;T_Tax_Computation&quot;,&quot;FinalTax.TaxRefundDueS&quot;,&quot;chkFinalTaxRefDue_Listener_&quot;,chkFinalTaxRefDue_Listener,chkFinalTaxRefDue)
	    &apos;thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If	
	
	Dim sheet as Object
	Dim msgStr As String

	sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	If( sheet.getCellrangeByName(&quot;RetInf.DeclareSelfBusIncome&quot;).string = &quot;No&quot; ) Then
	 Unprotectsheet(&quot;T_Tax_Computation&quot;)         
     ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.WithHoldingListSTO&quot;).value =0#
     protectsheet(&quot;T_Tax_Computation&quot;) 
	End If
	
	&apos;If( sheet.getCellrangeByName(&quot;RetInf.DeclareSelfBusIncome&quot;).string = &quot;Yes&quot; ) Then
		 Unprotectsheet(&quot;T_Tax_Computation&quot;)
		If(ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.MRI&quot;).value &gt; 0 And ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.MRI&quot;).value &lt;&gt; &quot;&quot; ) Then
			unprotectsheet(&quot;B_Profit_Loss_Account_Self&quot;)
			If(ThisComponent.Sheets.getByName(&quot;B_Profit_Loss_Account_Self&quot;).getCellrangeByName(&quot;RentalTotalSelf&quot;).value = &quot;&quot; Or ThisComponent.Sheets.getByName(&quot;B_Profit_Loss_Account_Self&quot;).getCellrangeByName(&quot;RentalTotalSelf&quot;).value = 0) Then	
				ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.MRI&quot;).string = 0#
			End If
			protectsheet(&quot;B_Profit_Loss_Account_Self&quot;) 
		End If
		protectsheet(&quot;T_Tax_Computation&quot;)
	&apos;End If
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.DeclareSelfBusIncome&quot;,&quot;DeclareSelfBusIncome_Listener_&quot;,DeclareSelfBusIncome_Listener,DeclareSelfBusIncome)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

sub DeclareWifeBusIncome_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(DeclareWifeBusIncome_Listener,DeclareWifeBusIncome)
	
	&apos;code
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	
	if  oSheet.name = &quot;Amendment&quot; then
		&apos;call addKRAListnersSingleCell(&quot;T_Tax_Computation&quot;,&quot;FinalTax.TaxRefundDueS&quot;,&quot;chkFinalTaxRefDue_Listener_&quot;,chkFinalTaxRefDue_Listener,chkFinalTaxRefDue)
	    &apos;thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If	
	
	Dim sheet as Object
	Dim msgStr As String

	sheet=ThisComponent.sheets.getByName(&quot;A_Basic_Info&quot;)
	&apos;If( sheet.getCellrangeByName(&quot;RetInf.DeclareWifeBusIncome&quot;).string = &quot;Yes&quot; ) Then
		 Unprotectsheet(&quot;T_Tax_Computation&quot;)
		If(ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.MRIWTO&quot;).value &gt; 0 And ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.MRIWTO&quot;).value &lt;&gt; &quot;&quot; ) Then
			unprotectsheet(&quot;B_Profit_Loss_Account_Wife&quot;)
			If(ThisComponent.Sheets.getByName(&quot;B_Profit_Loss_Account_Wife&quot;).getCellrangeByName(&quot;RentalTotalWife&quot;).value = &quot;&quot; Or ThisComponent.Sheets.getByName(&quot;B_Profit_Loss_Account_Wife&quot;).getCellrangeByName(&quot;RentalTotalWife&quot;).value = 0) Then	
				ThisComponent.Sheets.getByName(&quot;T_Tax_Computation&quot;).getCellrangeByName(&quot;TaxComp.MRIWTO&quot;).string = 0#
			End If
			protectsheet(&quot;B_Profit_Loss_Account_Wife&quot;) 
		End If
		protectsheet(&quot;T_Tax_Computation&quot;)
	&apos;End If
	call addKRAListnersSingleCell(&quot;A_Basic_Info&quot;,&quot;RetInf.DeclareWifeBusIncome&quot;,&quot;DeclareWifeBusIncome_Listener_&quot;,DeclareWifeBusIncome_Listener,DeclareWifeBusIncome)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
&apos;Added by vaishali gohil end
</script:module>