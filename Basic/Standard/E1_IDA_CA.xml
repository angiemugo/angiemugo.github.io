<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="E1_IDA_CA" script:language="StarBasic">&apos;*************************************
&apos;Add Row Functionality
&apos;E1_IDA_CA - Part1
&apos;Case : Self
&apos;*************************************
Sub addRow_E1_IDA_CAPart1List()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;IniAllPlanMach.ListPart1S&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(e1DateOfFirstIssue_Listener,e1DateOfFirstIssue)
    call removeKRAListners(p1InvestmenntDeduc_Listener,p1InvestmenntDeduc)
    call removeKRAListners(p1Location_Listener,p1Location)
    call removeKRAListners(p1Cost_Listener,p1Cost)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;E&quot;,&quot;e1DateOfFirstIssue_Listener_&quot;,e1DateOfFirstIssue_Listener,e1DateOfFirstIssue)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;H&quot;,&quot;p1InvestmenntDeduc_Listener_&quot;,p1InvestmenntDeduc_Listener,p1InvestmenntDeduc)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;F&quot;,&quot;p1Location_Listener_&quot;,p1Location_Listener,p1Location)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;G&quot;,&quot;p1Cost_Listener_&quot;,p1Cost_Listener,p1Cost)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;E1_IDA_CA - Part2
&apos;Case : Self
&apos;*************************************
Sub addRow_E1_IDA_CAPart2List()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;IniAllIBD.ListPart2S&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(e1DateOfFirstUse_Listener,e1DateOfFirstUse)
    call removeKRAListners(e1Cost_Listener,e1Cost)
    call removeKRAListners(e1InvestmenntDeduc_Listener,e1InvestmenntDeduc)
    call removeKRAListners(p2CapAll_Listener,p2CapAll)
    call removeKRAListners(p2ResVal_Listener,p2ResVal)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;B&quot;,&quot;e1DateOfFirstUse_Listener_&quot;,e1DateOfFirstUse_Listener,e1DateOfFirstUse)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;E&quot;,&quot;e1InvestmenntDeduc_Listener_&quot;,e1InvestmenntDeduc_Listener,e1InvestmenntDeduc)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;H&quot;,&quot;p2CapAll_Listener_&quot;,p2CapAll_Listener,p2CapAll)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;G&quot;,&quot;p2ResVal_Listener_&quot;,p2ResVal_Listener,p2ResVal)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;E1_IDA_CA - Part4
&apos;Case : Self
&apos;*************************************
Sub addRow_E1_IDA_CAPart4List()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;AgrLandDed.ListS&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(e1DateOfExpenditureP4_Listener,e1DateOfExpenditureP4)
    call removeKRAListners(p4WrtnDownVal_Listener,p4WrtnDownVal)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListS&quot;,&quot;B&quot;,&quot;e1DateOfExpenditureP4_Listener_&quot;,e1DateOfExpenditureP4_Listener,e1DateOfExpenditureP4)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListS&quot;,&quot;G&quot;,&quot;p4WrtnDownVal_Listener_&quot;,p4WrtnDownVal_Listener,p4WrtnDownVal)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;E1_IDA_CA - Part5
&apos;Case : Self
&apos;*************************************
Sub addRow_E1_IDA_CAPart5List()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;DeprIntengAst.ListS&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(e1DateOfFirstUseP5_Listener,e1DateOfFirstUseP5)
    call removeKRAListners(p5TotCost_Listener,p5TotCost)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListS&quot;,&quot;D&quot;,&quot;e1DateOfFirstUseP5_Listener_&quot;,e1DateOfFirstUseP5_Listener,e1DateOfFirstUseP5)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListS&quot;,&quot;H&quot;,&quot;p5TotCost_Listener_&quot;,p5TotCost_Listener,p5TotCost)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Check on Date Of First Use
&apos;D_Stock_Analysis - Part1
&apos;Case : Self
&apos;*************************************
sub e1DateOfFirstIssue_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1DateOfFirstIssue_Listener,e1DateOfFirstIssue)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;E&quot;,&quot;e1DateOfFirstIssue_Listener_&quot;,e1DateOfFirstIssue_Listener,e1DateOfFirstIssue)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
		Dim endDate as String
		Dim startDate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllPlanMach.ListPart1S&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;E&quot;&amp;(startRowNum+1)&amp;&quot;:E&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;E1_IDA_CA&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim currentDate As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			currentDate= currRange.string
			row= currRange.getCellAddress().Row 
	         If currentDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(currentDate) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(currentDate)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   &apos;MsgBox &quot;Date of First Use should be before or within return period.&quot;
			        		    MsgBox &quot;Date of First Use in Row &quot; &amp; (row+1) &amp; &quot; should be within Return Period &quot; &amp; startDate &amp; &quot; and &quot; &amp; endDate &amp;&quot;.&quot;
	             	End If
	        	 End If
	        End If
		End If
		protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;E&quot;,&quot;e1DateOfFirstIssue_Listener_&quot;,e1DateOfFirstIssue_Listener,e1DateOfFirstIssue)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Investment Deduction
&apos;D_Stock_Analysis - Part1
&apos;Case : Self
&apos;*************************************
sub p1InvestmenntDeduc_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p1InvestmenntDeduc_Listener,p1InvestmenntDeduc)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart1&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	

		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllPlanMach.ListPart1S&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		
		Dim cost as String
		Dim investment as String
		Dim location as String
		Dim costVal as Double
		Dim invVal as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		investment = currRange.value
		row = currRange.getCellAddress().Row 
		location = sheet.getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string
		cost = Cstr(sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp;(row+1)).value)
		investment = Cstr(sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value)
		costVal=sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)).value
		invVal=sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value

			
			If costVal= &quot;&quot; or costVal= 0 then
			Else
			
				If location= &quot;&quot; then
					MsgBox &quot;Please Select Location first&quot;
					currRange.STRING=&quot;&quot;
					&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp;(row+1)))
					goto endfunction
				End If				
				if location=&quot;LC3&quot; then 
					possibleinvest= costval * 150 / 100
				elseIf location=&quot;LC1&quot; or location = &quot;LC2&quot; or location = &quot;LC4&quot; then
					possibleinvest=costval
				End If
				If (possibleinvest &lt; invVal) then
		   		     currRange.string=&quot;&quot;
		   		     if possibleinvest= costval then
		   		     	MsgBox &quot;Investment cannot be greater than 100% of the Cost.&quot;
		   		     Else
		   		     	MsgBox &quot;Investment cannot be greater than 150% of the Cost.&quot;	   		     
		   		     End If	
		   		     &apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;H&quot; &amp; (row+1) &amp; &quot;:H&quot; &amp;(row+1)))
				End if
			End If

	&apos;code
endFunction:	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;H&quot;,&quot;p1InvestmenntDeduc_Listener_&quot;,p1InvestmenntDeduc_Listener,p1InvestmenntDeduc)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Location
&apos;D_Stock_Analysis - Part1
&apos;Case : Self
&apos;*************************************
sub p1Location_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p1Location_Listener,p1Location)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart1&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	

		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllPlanMach.ListPart1S&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		
		Dim cost as String
		Dim investment as String
		Dim location as String
		Dim costVal as Double
		Dim invVal as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		locationStr = currRange.String
		row = currRange.getCellAddress().Row 
		if locationStr&lt;&gt;&quot;&quot; then
		location = sheet.getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string
		cost = Cstr(sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp;(row+1)).value)
		investment = Cstr(sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value)
		costVal=sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)).value
		invVal=sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value
	
			If cost&lt;&gt; 0 or costVal&lt;&gt; 0 then
						if costval&lt;200000000 and location=&quot;LC3&quot; then
							MsgBox &quot;Cost of Item is less than 200 million (Ksh). Please select appropriate location.&quot;
							currRange.String=&quot;&quot;
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot;&amp;(row+1)&amp;&quot;:F&quot;&amp;(row+1)))
							goto endfunction
						End If
						if costval&gt;=200000000 and location=&quot;LC4&quot;  then
							MsgBox &quot;Cost of Item is greater than or equal to 200 million (Ksh). Please select appropriate location.&quot;
							currRange.String=&quot;&quot;
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot;&amp;(row+1)&amp;&quot;:F&quot;&amp;(row+1)))
							goto endfunction
						End If
						If investment&lt;&gt; 0 or invVal&lt;&gt; 0 then
							If costval&lt;invVal and (location=&quot;LC1&quot; or location=&quot;LC2&quot;) then
								MsgBox &quot;Investment cannot be greater than 100% of the Cost.&quot;
								currRange.String=&quot;&quot;
								&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot;&amp;(row+1)&amp;&quot;:F&quot;&amp;(row+1)))
								goto endfunction
							End If
						End If
			End If
		End If			

	&apos;code
endFunction:	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;F&quot;,&quot;p1Location_Listener_&quot;,p1Location_Listener,p1Location)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Cost
&apos;D_Stock_Analysis - Part1
&apos;Case : Self
&apos;*************************************
sub p1Cost_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p1Cost_Listener,p1Cost)
	call removeKRAListners(p1InvestmenntDeduc_Listener,p1InvestmenntDeduc)
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart1&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	

		Dim cost as String
		Dim investment as String
		Dim location as String
		Dim costVal as Double
		Dim invVal as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		Dim minCost as Double
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		cost = currRange.String
		row = currRange.getCellAddress().Row 
		if cost&lt;&gt;&quot;&quot; then
		location = sheet.getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string
		cost = Cstr(sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp;(row+1)).value)
		investment = Cstr(sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value)
		costVal=sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)).value
		invVal=sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value
	
			If location&lt;&gt; &quot;&quot;  then
				if investment&lt;&gt;0 or invVal&lt;&gt;0 then
						if costval&lt;200000000 and location=&quot;LC3&quot; then
							MsgBox &quot;Cost of Item against the selected Location must be greater than or equal to 200 million (Ksh).&quot;
							currRange.String=&quot;&quot;
							&apos;sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)))
							goto endfunction
						End If
						if costval&gt;=200000000 and location=&quot;LC4&quot; then
							MsgBox &quot;Cost of Item against the selected Location must be less than 200 million (Ksh).&quot;
							currRange.String=&quot;&quot;
							&apos;sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;							
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)))
							goto endfunction
						End If
						if location=&quot;LC3&quot; then 
							minCost= Format(invVal * 100 / 150,0)
						elseIf location=&quot;LC1&quot; or location = &quot;LC2&quot; or location = &quot;LC4&quot; then
							minCost=invVal
						End If
						If (minCost &gt; costVal) then
				   		     currRange.string=&quot;&quot;
				   		     if minCost= invVal then
				   		     	MsgBox &quot;Investment cannot be greater than 100% of the Cost.&quot;
				   		     Else
				   		     	MsgBox &quot;Investment cannot be greater than 150% of the Cost.&quot;	   		     
				   		     End If	
				   		     &apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;H&quot; &amp; (row+1) &amp; &quot;:H&quot; &amp;(row+1)))
						End if
				Else
						if costval&lt;200000000 and location=&quot;LC3&quot; then
							MsgBox &quot;Cost of Item against the selected Location must be greater than or equal to 200 million (Ksh).&quot;
							currRange.String=&quot;&quot;
							&apos;sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)))
							goto endfunction
						End If
						if costval&gt;=200000000 and location=&quot;LC4&quot; then
							MsgBox &quot;Cost of Item against the selected Location must be less than 200 million (Ksh).&quot;
							currRange.String=&quot;&quot;
							&apos;sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;							
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)))
							goto endfunction
						End If
						if location=&quot;LC3&quot; then 
							possibleinvest= costval * 150 / 100
						elseIf location=&quot;LC1&quot; or location = &quot;LC2&quot; then
							possibleinvest=costval
						End If
						If (possibleinvest &lt; invVal) then
				   		     currRange.string=&quot;&quot;
				   		     if possibleinvest= costval then
				   		     	MsgBox &quot;Investment cannot be greater than 100% of the Cost.&quot;
				   		     Else
				   		     	MsgBox &quot;Investment cannot be greater than 150% of the Cost.&quot;	   		     
				   		     End If	
				   		     &apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;H&quot; &amp; (row+1) &amp; &quot;:H&quot; &amp;(row+1)))
						End if
				End if
			Else
				MsgBox &quot;Please Select Location first&quot;
				currRange.String=&quot;&quot;
				sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;	
				&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp;(row+1)))
				goto endfunction
			End If
		End If			

	&apos;code
endFunction:	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;H&quot;,&quot;p1InvestmenntDeduc_Listener_&quot;,p1InvestmenntDeduc_Listener,p1InvestmenntDeduc)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1S&quot;,&quot;G&quot;,&quot;p1Cost_Listener_&quot;,p1Cost_Listener,p1Cost)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
		
&apos;*************************************
&apos;Check on Date Of First Use
&apos;D_Stock_Analysis - Part2
&apos;Case : Self
&apos;*************************************
sub e1DateOfFirstUse_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1DateOfFirstUse_Listener,e1DateOfFirstUse)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;B&quot;,&quot;e1DateOfFirstUse_Listener_&quot;,e1DateOfFirstUse_Listener,e1DateOfFirstUse)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
		Dim endDate as String
		Dim startDate as String
		Dim dateFrom As String
		Dim year as String
		Dim month as String
		Dim day as String
		Dim endDt as Object
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2S&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;B&quot;&amp;(startRowNum+1)&amp;&quot;:B&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;E1_IDA_CA&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim currentDate As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			currentDate= currRange.string
			row= currRange.getCellAddress().Row 
	         If currentDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(currentDate) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
			       	     sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=&quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            Else
		            	endDt= Split(endDate,&quot;/&quot;)
	              		year=INT(endDt(2))
	              		month=INT(endDt(1))
	              		day=INT(endDt(0))
			            If lessThnEqualToReturnYr(currentDate,year,month,day)=False Then
				        		   currRange.string = &quot;&quot;
				        		   sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=&quot;&quot;
				        		   msgStr = msgStr &amp; (row+1)
				        		   MsgBox &quot;Date of First Use in Row &quot; &amp; (row+1) &amp; &quot; should be before or within Return Period.&quot;
				        Else
			        	&apos;Calculate the number of days.
			        	if DayDifference(currentDate,endDate) &gt; DayDifference(startDate,endDate) then
			        		sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=Cstr(DayDifference(startDate,endDate)+1)
			        	else
			        		sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=Cstr(DayDifference(currentDate,endDate)+1)
			        	End If
	             		End If
	             	End If
	        	 End If
	        Else
	        	sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=&quot;&quot;
	        End If
		End If
		protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;B&quot;,&quot;e1DateOfFirstUse_Listener_&quot;,e1DateOfFirstUse_Listener,e1DateOfFirstUse)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Cost
&apos;D_Stock_Analysis - Part2
&apos;Case : Self
&apos;*************************************
sub e1Cost_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1Cost_Listener,e1Cost)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2S&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;D&quot;&amp;(startRowNum+1)&amp;&quot;:D&quot;&amp;(endRowNum+1))
		Unprotectsheet(&quot;E1_IDA_CA&quot;)
		Dim cost as Double
		Dim investment as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			cost = currRange.value
			row = currRange.getCellAddress().Row 
			investment = sheet.getCellrangeByName(&quot;E&quot; &amp; (row+1) &amp; &quot;:E&quot; &amp; (row+1)).value
			investmentString = sheet.getCellrangeByName(&quot;E&quot; &amp; (row+1) &amp; &quot;:E&quot; &amp; (row+1)).string
			
			If investmentString &lt;&gt; &quot;&quot; then
			If (investment &gt; cost) and currRange.string&lt;&gt;&quot;&quot; then
	   		     currRange.string=&quot;&quot;
	   		     MsgBox &quot;Investment cannot be greater than Cost.&quot;
			End if
			End if
		End If
	End if
	Protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Investment Deduction
&apos;D_Stock_Analysis - Part2
&apos;Case : Self
&apos;*************************************
sub e1InvestmenntDeduc_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1InvestmenntDeduc_Listener,e1InvestmenntDeduc)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2S&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;D&quot;&amp;(startRowNum+1)&amp;&quot;:D&quot;&amp;(endRowNum+1))
		Unprotectsheet(&quot;E1_IDA_CA&quot;)
		Dim cost as Double
		Dim investment as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			investment = currRange.value
			row = currRange.getCellAddress().Row 
			cost = sheet.getCellrangeByName(&quot;D&quot; &amp; (row+1) &amp; &quot;:D&quot; &amp; (row+1)).value
			costString = sheet.getCellrangeByName(&quot;D&quot; &amp; (row+1) &amp; &quot;:D&quot; &amp; (row+1)).string
			
			If costString &lt;&gt; &quot;&quot; then
			If (investment &gt; cost) and currRange.string&lt;&gt;&quot;&quot; then
	   		     currRange.string=&quot;&quot;
	   		     MsgBox &quot;Investment cannot be greater than Cost.&quot;
			End if
			End if
		End If
	End if
	Protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;E&quot;,&quot;e1InvestmenntDeduc_Listener_&quot;,e1InvestmenntDeduc_Listener,e1InvestmenntDeduc)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Capital Allowance
&apos;D_Stock_Analysis - Part2
&apos;Case : Self
&apos;*************************************
sub p2CapAll_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p2CapAll_Listener,p2CapAll)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2S&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;H&quot;&amp;(startRowNum+1)&amp;&quot;:H&quot;&amp;(endRowNum+1))
		
		Dim qualfAll as Double
		Dim resVal as Double
		Dim capAllVal as Double
		Dim capAllStr as String
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Double
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			capAllStr = currRange.String
			capAllVal= currRange.value
			row = currRange.getCellAddress().Row 
			qualfAll = sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp; (row+1)).value
			resVal = sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp; (row+1)).Value
			if capAllStr&lt;&gt;&quot;&quot; then
				if (qualfAll+ resVal) &lt;&gt;0 then
					If ((qualfAll+ resVal)&lt; capAllVal) then
			   		     currRange.string=&quot;&quot;
			   		     MsgBox &quot;Capital Allowance in row &quot; &amp; (row+1)  &amp; &quot; should be less than or equal to sum of values in C and D.&quot;
					End if
				End If
			End If
		End If
	End if
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;H&quot;,&quot;p2CapAll_Listener_&quot;,p2CapAll_Listener,p2CapAll)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Residual Value
&apos;D_Stock_Analysis - Part2
&apos;Case : Self
&apos;*************************************
sub p2ResVal_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p2ResVal_Listener,p2ResVal)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2S&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;G&quot;&amp;(startRowNum+1)&amp;&quot;:G&quot;&amp;(endRowNum+1))
		
		Dim qualfAll as Double
		Dim resVal as Double
		Dim capAllVal as Double
		Dim resValStr as String
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			resValStr = currRange.String
			resVal= currRange.value
			row = currRange.getCellAddress().Row 
			qualfAll = sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp; (row+1)).value
			capAllVal = sheet.getCellrangeByName(&quot;H&quot; &amp; (row+1) &amp; &quot;:H&quot; &amp; (row+1)).Value
			if resValStr&lt;&gt;&quot;&quot; then
				if (qualfAll+ resVal) &lt;&gt;0 then
					If ((qualfAll+ resVal)&lt; capAllVal) then
			   		     currRange.string=&quot;&quot;
			   		     MsgBox &quot;Capital Allowance in row &quot; &amp; (row+1)  &amp; &quot; should be less than or equal to sum of values in C and D.&quot;
					End if
				End If
			End If
		End If
	End if
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2S&quot;,&quot;G&quot;,&quot;p2ResVal_Listener_&quot;,p2ResVal_Listener,p2ResVal)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
	
&apos;*************************************
&apos;Check on Date Of Expenditure
&apos;D_Stock_Analysis - Part4
&apos;Case : Self
&apos;*************************************
sub e1DateOfExpenditureP4_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1DateOfExpenditureP4_Listener,e1DateOfExpenditureP4)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListS&quot;,&quot;B&quot;,&quot;e1DateOfExpenditureP4_Listener_&quot;,e1DateOfExpenditureP4_Listener,e1DateOfExpenditureP4)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
		Dim endDate as String
		Dim startDate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;AgrLandDed.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;B&quot;&amp;(startRowNum+1)&amp;&quot;:B&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;E1_IDA_CA&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim currentDate As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			currentDate= currRange.string
			row= currRange.getCellAddress().Row 
	         If currentDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(currentDate) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(currentDate)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   &apos;MsgBox &quot;Date of Expenditure should be before or within return period.&quot;
			        		   MsgBox &quot;Date of Expenditure in Row &quot; &amp; (row+1) &amp; &quot; should be within Return Period &quot; &amp; startDate &amp; &quot; and &quot; &amp; endDate &amp;&quot;.&quot;
	             	End If
	        	 End If
	        End If
		End If
		protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListS&quot;,&quot;B&quot;,&quot;e1DateOfExpenditureP4_Listener_&quot;,e1DateOfExpenditureP4_Listener,e1DateOfExpenditureP4)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Written Down Value
&apos;D_Stock_Analysis - Part4
&apos;Case : Self
&apos;*************************************
sub p4WrtnDownVal_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p4WrtnDownVal_Listener,p4WrtnDownVal)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;AgrLandDed.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;G&quot;&amp;(startRowNum+1)&amp;&quot;:G&quot;&amp;(endRowNum+1))
		
		Dim ACostVal as Double
		Dim BCostVal as Double
		Dim CCostVal As Double
		Dim DCostVal As Double
		Dim msgStr As String
		Dim currRange as Object
		Dim amt as Double
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		
		
			row = currRange.getCellAddress().Row 
			col=currRange.getCellAddress().column
			labelName=sheet.getCellByPosition(col,startRowNum-1).string
		
			ACostVal=  sheet.getCellrangeByName(&quot;C&quot; &amp; (row+1) &amp; &quot;:C&quot; &amp; (row+1)).Value
			BCostVal = sheet.getCellrangeByName(&quot;D&quot; &amp; (row+1) &amp; &quot;:D&quot; &amp; (row+1)).value
			CCostVal = sheet.getCellrangeByName(&quot;E&quot; &amp; (row+1) &amp; &quot;:E&quot; &amp; (row+1)).Value
			DCostVal = sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp; (row+1)).Value
			amt=ACostVal+BCostVal-CCostVal-DCostVal
			if amt&lt;0 then
				currRange.string=&quot;&quot;
				MsgBox Trim(labelName) &amp; &quot; should be less than or equal to A+B.&quot;
			End if
		
	End if
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListS&quot;,&quot;G&quot;,&quot;p4WrtnDownVal_Listener_&quot;,p4WrtnDownVal_Listener,p4WrtnDownVal)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
	
&apos;*************************************
&apos;Check on Date Of First Use
&apos;D_Stock_Analysis - Part5
&apos;Case : Self
&apos;*************************************
sub e1DateOfFirstUseP5_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1DateOfFirstUseP5_Listener,e1DateOfFirstUseP5)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListS&quot;,&quot;D&quot;,&quot;e1DateOfFirstUseP5_Listener_&quot;,e1DateOfFirstUseP5_Listener,e1DateOfFirstUseP5)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
		Dim endDate as String
		Dim startDate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;DeprIntengAst.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;D&quot;&amp;(startRowNum+1)&amp;&quot;:D&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;E1_IDA_CA&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim purchaseDate as String
		Dim dateFrom As String
		Dim year as String
		Dim month as String
		Dim day as String
		Dim endDt as Object
		Dim possibleDate as String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			purchaseDate= currRange.string
			row= currRange.getCellAddress().Row 
	         If purchaseDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(purchaseDate) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            Else
		            	endDt= Split(endDate,&quot;/&quot;)
	              		year=INT(endDt(2))
	              		month=INT(endDt(1))
	              		day=INT(endDt(0))
	              		possibleDate = specificDateBeforeYears(startDate,6)
			            If lessThnEqualToReturnYr(purchaseDate,year,month,day)=False Then
				        		   currRange.string = &quot;&quot;
				        		   msgStr = msgStr &amp; (row+1)
				        		   MsgBox &quot;Date of First Use should be before or within Return Period.&quot;
				        ElseIf TestDateBtwnRtnPeriod(purchaseDate)=True Then
			        		   sheet.getCellrangeByName(&quot;E&quot;&amp;(row+1)&amp;&quot;:E&quot;&amp;(row+1)).value=40
			        		   &apos;MsgBox &quot;Date is between return period.&quot;
			        	ElseIf (checkGrtrThnDate(possibleDate,purchaseDate)) = True Then
	                           sheet.getCellrangeByName(&quot;E&quot;&amp;(row+1)&amp;&quot;:E&quot;&amp;(row+1)).value=10
		        		       &apos;MsgBox &quot;Date is between 6 years before return period to date to return period to date.&quot;
			        	Else
			        		   sheet.getCellrangeByName(&quot;E&quot;&amp;(row+1)&amp;&quot;:E&quot;&amp;(row+1)).value=0
			        		   &apos;MsgBox &quot;Date is not between return period.&quot;
	             		End If
	             	End If
	         	End If
	         Else
	         	sheet.getCellrangeByName(&quot;E&quot;&amp;(row+1)&amp;&quot;:E&quot;&amp;(row+1)).string=&quot;&quot;
	         End If
		End If
		protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListS&quot;,&quot;D&quot;,&quot;e1DateOfFirstUseP5_Listener_&quot;,e1DateOfFirstUseP5_Listener,e1DateOfFirstUseP5)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Total Cost
&apos;D_Stock_Analysis - Part1
&apos;Case : Self
&apos;*************************************
sub p5TotCost_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p5TotCost_Listener,p5TotCost)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;DeprIntengAst.ListS&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;H&quot;&amp;(startRowNum+1)&amp;&quot;:H&quot;&amp;(endRowNum+1))
		
		Dim BCostVal as Double
		Dim CCostVal as Double
	
		Dim msgStr As String
		Dim currRange as Object
		Dim amt as Double
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		
		
			row = currRange.getCellAddress().Row 
			col=currRange.getCellAddress().column
			
			BCostVal=  sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp; (row+1)).Value
			CCostVal = sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp; (row+1)).value
		
			amt=BCostVal-CCostVal
			if amt&lt;0 then
				currRange.string=&quot;&quot;
			   	if col=6 then
			   		MsgBox &quot;Disposal at Cost during the Year should be less than or equal to Actual Cost.&quot;
			   	else
				   MsgBox &quot;Actual Cost should be greater than or equal to Disposal at Cost during the Year.&quot;
			   	End If
			   	
			End if
		
	End if
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListS&quot;,&quot;H&quot;,&quot;p5TotCost_Listener_&quot;,p5TotCost_Listener,p5TotCost)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Add Row Functionality
&apos;E1_IDA_CA - Part1
&apos;Case : Wife
&apos;*************************************
Sub addRow_E1_IDA_CAPart1WifeList()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;IniAllPlanMach.ListPart1W&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(e1DateOfFirstIssueW_Listener,e1DateOfFirstIssueW)
    call removeKRAListners(p1InvestmenntDeducW_Listener,p1InvestmenntDeducW)
    call removeKRAListners(p1LocationW_Listener,p1LocationW)
    call removeKRAListners(p1CostW_Listener,p1CostW)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;E&quot;,&quot;e1DateOfFirstIssueW_Listener_&quot;,e1DateOfFirstIssueW_Listener,e1DateOfFirstIssueW)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;H&quot;,&quot;p1InvestmenntDeducW_Listener_&quot;,p1InvestmenntDeducW_Listener,p1InvestmenntDeducW)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;F&quot;,&quot;p1LocationW_Listener_&quot;,p1LocationW_Listener,p1LocationW)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;G&quot;,&quot;p1CostW_Listener_&quot;,p1CostW_Listener,p1CostW)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;E1_IDA_CA - Part2
&apos;Case : Wife
&apos;*************************************
Sub addRow_E1_IDA_CAPart2WifeList()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;IniAllIBD.ListPart2W&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(e1DateOfFirstUseW_Listener,e1DateOfFirstUseW)
    call removeKRAListners(e1CostW_Listener,e1CostW)
    call removeKRAListners(e1InvestmenntDeducW_Listener,e1InvestmenntDeducW)
    call removeKRAListners(p2CapAllW_Listener,p2CapAllW)
    call removeKRAListners(p2ResValW_Listener,p2ResValW)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;B&quot;,&quot;e1DateOfFirstUseW_Listener_&quot;,e1DateOfFirstUseW_Listener,e1DateOfFirstUseW)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;D&quot;,&quot;e1CostW_Listener_&quot;,e1CostW_Listener,e1CostW)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;E&quot;,&quot;e1InvestmenntDeducW_Listener_&quot;,e1InvestmenntDeducW_Listener,e1InvestmenntDeducW)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;H&quot;,&quot;p2CapAllW_Listener_&quot;,p2CapAllW_Listener,p2CapAllW)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;G&quot;,&quot;p2ResValW_Listener_&quot;,p2ResValW_Listener,p2ResValW)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;E1_IDA_CA - Part4
&apos;Case : Wife
&apos;*************************************
Sub addRow_E1_IDA_CAPart4WifeList()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;AgrLandDed.ListW&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(e1DateOfExpenditureP4W_Listener,e1DateOfExpenditureP4W)
    call removeKRAListners(p4WrtnDownValW_Listener,p4WrtnDownValW)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListW&quot;,&quot;B&quot;,&quot;e1DateOfExpenditureP4W_Listener_&quot;,e1DateOfExpenditureP4W_Listener,e1DateOfExpenditureP4W)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListW&quot;,&quot;G&quot;,&quot;p4WrtnDownValW_Listener_&quot;,p4WrtnDownValW_Listener,p4WrtnDownValW)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Add Row Functionality
&apos;E1_IDA_CA - Part5
&apos;Case : Wife
&apos;*************************************
Sub addRow_E1_IDA_CAPart5WifeList()
	notCallListener = true
    Call InsertRowsAndFillFormulas(&quot;DeprIntengAst.ListW&quot;)
    &apos;Add All Remove Listeners
    call removeKRAListners(e1DateOfFirstUseP5W_Listener,e1DateOfFirstUseP5W)
    call removeKRAListners(p5TotCostW_Listener,p5TotCostW)
    &apos;Add All Add Listeners
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListW&quot;,&quot;D&quot;,&quot;e1DateOfFirstUseP5W_Listener_&quot;,e1DateOfFirstUseP5W_Listener,e1DateOfFirstUseP5W)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListW&quot;,&quot;H&quot;,&quot;p5TotCostW_Listener_&quot;,p5TotCostW_Listener,p5TotCostW)
    notCallListener = false
End Sub

&apos;*************************************
&apos;Check on Date Of First Use
&apos;D_Stock_Analysis - Part1
&apos;Case : Wife
&apos;*************************************
sub e1DateOfFirstIssueW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1DateOfFirstIssueW_Listener,e1DateOfFirstIssueW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;E&quot;,&quot;e1DateOfFirstIssueW_Listener_&quot;,e1DateOfFirstIssueW_Listener,e1DateOfFirstIssueW)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
		Dim endDate as String
		Dim startDate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllPlanMach.ListPart1W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;E&quot;&amp;(startRowNum+1)&amp;&quot;:E&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;E1_IDA_CA&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim currentDate As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			currentDate= currRange.string
			row= currRange.getCellAddress().Row 
	         If currentDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(currentDate) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(currentDate)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   &apos;MsgBox &quot;Date of First Use should be before or within return period.&quot;
			        		   MsgBox &quot;Date of First Use in Row &quot; &amp; (row+1) &amp; &quot; should be within Return Period &quot; &amp; startDate &amp; &quot; and &quot; &amp; endDate &amp;&quot;.&quot;
	             	End If
	        	 End If
	        End If
		End If
		protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;E&quot;,&quot;e1DateOfFirstIssueW_Listener_&quot;,e1DateOfFirstIssueW_Listener,e1DateOfFirstIssueW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Investment Deduction
&apos;D_Stock_Analysis - Part1
&apos;Case : Wife
&apos;*************************************
sub p1InvestmenntDeducW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p1InvestmenntDeducW_Listener,p1InvestmenntDeducW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart1&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	

		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllPlanMach.ListPart1W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		
		Dim cost as String
		Dim investment as String
		Dim location as String
		Dim costVal as Double
		Dim invVal as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		investment = currRange.value
		row = currRange.getCellAddress().Row 
		location = sheet.getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string
		cost = Cstr(sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp;(row+1)).value)
		investment = Cstr(sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value)
		costVal=sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)).value
		invVal=sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value

			
			If costVal= &quot;&quot; or costVal= 0 then
			Else
			
				If location= &quot;&quot; then
					MsgBox &quot;Please Select Location first&quot;
					currRange.STRING=&quot;&quot;
					&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp;(row+1)))
					goto endfunction
				End If				
				if location=&quot;LC3&quot; then 
					possibleinvest= costval * 150 / 100
				elseIf location=&quot;LC1&quot; or location = &quot;LC2&quot; or location=&quot;LC4&quot; then
					possibleinvest=costval
				End If
				If (possibleinvest &lt; invVal) then
		   		     currRange.string=&quot;&quot;
		   		     if possibleinvest= costval then
		   		     	MsgBox &quot;Investment cannot be greater than 100% of the Cost.&quot;
		   		     Else
		   		     	MsgBox &quot;Investment cannot be greater than 150% of the Cost.&quot;	   		     
		   		     End If	
		   		     &apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;H&quot; &amp; (row+1) &amp; &quot;:H&quot; &amp;(row+1)))
				End if
			End If
		

	&apos;code
endFunction:	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;H&quot;,&quot;p1InvestmenntDeducW_Listener_&quot;,p1InvestmenntDeducW_Listener,p1InvestmenntDeducW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Location
&apos;D_Stock_Analysis - Part1
&apos;Case : Wife
&apos;*************************************
sub p1LocationW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p1LocationW_Listener,p1LocationW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart1&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	

		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllPlanMach.ListPart1W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		
		Dim cost as String
		Dim investment as String
		Dim location as String
		Dim costVal as Double
		Dim invVal as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		locationStr = currRange.String
		row = currRange.getCellAddress().Row 
		if locationStr&lt;&gt;&quot;&quot; then
		location = sheet.getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string
		cost = Cstr(sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp;(row+1)).value)
		investment = Cstr(sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value)
		costVal=sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)).value
		invVal=sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value
	
			If cost&lt;&gt; 0 or costVal&lt;&gt; 0 then
						if costval&lt;200000000 and location=&quot;LC3&quot; then
							MsgBox &quot;Cost of Item is less than 200 million (Ksh). Please select appropriate location.&quot;
							currRange.String=&quot;&quot;
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot;&amp;(row+1)&amp;&quot;:F&quot;&amp;(row+1)))
							goto endfunction
						End If
						if costval&gt;=200000000 and location=&quot;LC4&quot; then
							MsgBox &quot;Cost of Item is greater than or equal to 200 million (Ksh). Please select appropriate location.&quot;
							currRange.String=&quot;&quot;
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot;&amp;(row+1)&amp;&quot;:F&quot;&amp;(row+1)))
							goto endfunction
						End If
						If investment&lt;&gt; 0 or invVal&lt;&gt; 0 then
							If costval&lt;invVal and (location=&quot;LC1&quot; or location=&quot;LC2&quot;) then
								MsgBox &quot;Investment cannot be greater than 100% of the Cost.&quot;
								currRange.String=&quot;&quot;
								&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot;&amp;(row+1)&amp;&quot;:F&quot;&amp;(row+1)))
								goto endfunction
							End If
						End If
			End If
		End If			

	&apos;code
endFunction:	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;F&quot;,&quot;p1LocationW_Listener_&quot;,p1LocationW_Listener,p1LocationW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Cost
&apos;D_Stock_Analysis - Part1
&apos;Case : Wife
&apos;*************************************
sub p1CostW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p1CostW_Listener,p1CostW)
	call removeKRAListners(p1InvestmenntDeducW_Listener,p1InvestmenntDeducW)
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart1&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	

		Dim cost as String
		Dim investment as String
		Dim location as String
		Dim costVal as Double
		Dim invVal as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		Dim minCost as Double
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		cost = currRange.String
		row = currRange.getCellAddress().Row 
		if cost&lt;&gt;&quot;&quot; then
		location = sheet.getCellrangeByName(&quot;I&quot;&amp;(row+1)&amp;&quot;:I&quot;&amp;(row+1)).string
		cost = Cstr(sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp;(row+1)).value)
		investment = Cstr(sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value)
		costVal=sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)).value
		invVal=sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).value
	
		If location&lt;&gt; &quot;&quot;  then
				if investment&lt;&gt;0 or invVal&lt;&gt;0 then
						if costval&lt;200000000 and location=&quot;LC3&quot; then
							MsgBox &quot;Cost of Item against the selected Location must be greater than or equal to 200 million (Ksh).&quot;
							currRange.String=&quot;&quot;
							&apos;sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)))
							goto endfunction
						End If
						if costval&gt;=200000000 and location=&quot;LC4&quot; then
							MsgBox &quot;Cost of Item against the selected Location must be less than 200 million (Ksh).&quot;
							currRange.String=&quot;&quot;
							&apos;sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;							
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)))
							goto endfunction
						End If
						if location=&quot;LC3&quot; then 
							minCost= Format(invVal * 100 / 150,0)
						elseIf location=&quot;LC1&quot; or location = &quot;LC2&quot; or location = &quot;LC4&quot; then
							minCost=invVal
						End If
						If (minCost &gt; costVal) then
				   		     currRange.string=&quot;&quot;
				   		     if minCost= invVal then
				   		     	MsgBox &quot;Investment cannot be greater than 100% of the Cost.&quot;
				   		     Else
				   		     	MsgBox &quot;Investment cannot be greater than 150% of the Cost.&quot;	   		     
				   		     End If	
				   		     &apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;H&quot; &amp; (row+1) &amp; &quot;:H&quot; &amp;(row+1)))
						End if
				Else
						if costval&lt;200000000 and location=&quot;LC3&quot; then
							MsgBox &quot;Cost of Item against the selected Location must be greater than or equal to 200 million (Ksh).&quot;
							currRange.String=&quot;&quot;
							&apos;sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)))
							goto endfunction
						End If
						if costval&gt;=200000000 and location=&quot;LC4&quot; then
							MsgBox &quot;Cost of Item against the selected Location must be less than 200 million (Ksh).&quot;
							currRange.String=&quot;&quot;
							&apos;sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;							
							&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;G&quot;&amp;(row+1)&amp;&quot;:G&quot;&amp;(row+1)))
							goto endfunction
						End If
						if location=&quot;LC3&quot; then 
							possibleinvest= costval * 150 / 100
						elseIf location=&quot;LC1&quot; or location = &quot;LC2&quot; or location = &quot;LC4&quot; then
							possibleinvest=costval
						End If
						If (possibleinvest &lt; invVal) then
				   		     currRange.string=&quot;&quot;
				   		     if possibleinvest= costval then
				   		     	MsgBox &quot;Investment cannot be greater than 100% of the Cost.&quot;
				   		     Else
				   		     	MsgBox &quot;Investment cannot be greater than 150% of the Cost.&quot;	   		     
				   		     End If	
				   		     &apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;H&quot; &amp; (row+1) &amp; &quot;:H&quot; &amp;(row+1)))
						End if
				End if
			Else
				MsgBox &quot;Please Select Location first&quot;
				currRange.String=&quot;&quot;
				sheet.getCellrangeByName(&quot;H&quot;&amp;(row+1)&amp;&quot;:H&quot;&amp;(row+1)).string=&quot;&quot;	
				&apos;ThisComponent.CurrentController.Select(sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp;(row+1)))
				goto endfunction
			End If
		End If			

	&apos;code
endFunction:	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;H&quot;,&quot;p1InvestmenntDeducW_Listener_&quot;,p1InvestmenntDeducW_Listener,p1InvestmenntDeducW)
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllPlanMach.ListPart1W&quot;,&quot;G&quot;,&quot;p1CostW_Listener_&quot;,p1CostW_Listener,p1CostW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
		
&apos;*************************************
&apos;Check on Date Of First Use
&apos;D_Stock_Analysis - Part2
&apos;Case : Wife
&apos;*************************************
sub e1DateOfFirstUseW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1DateOfFirstUseW_Listener,e1DateOfFirstUseW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;B&quot;,&quot;e1DateOfFirstUseW_Listener_&quot;,e1DateOfFirstUseW_Listener,e1DateOfFirstUseW)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
		Dim endDate as String
		Dim startDate as String
		Dim dateFrom As String
		Dim year as String
		Dim month as String
		Dim day as String
		Dim endDt as Object
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;B&quot;&amp;(startRowNum+1)&amp;&quot;:B&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;E1_IDA_CA&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim currentDate As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			currentDate= currRange.string
			row= currRange.getCellAddress().Row 
	         If currentDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(currentDate) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
			       	     sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=&quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            Else
		            	endDt= Split(endDate,&quot;/&quot;)
	              		year=INT(endDt(2))
	              		month=INT(endDt(1))
	              		day=INT(endDt(0))
			            If lessThnEqualToReturnYr(currentDate,year,month,day)=False Then
				        		   currRange.string = &quot;&quot;
				        		   sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=&quot;&quot;
				        		   msgStr = msgStr &amp; (row+1)
				        		   MsgBox &quot;Date of First Use in Row &quot; &amp; (row+1) &amp; &quot; should be before or within Return Period.&quot;
				        Else
			        	&apos;Calculate the number of days.
			        	if DayDifference(currentDate,endDate) &gt; DayDifference(startDate,endDate) then
			        		sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=Cstr(DayDifference(startDate,endDate)+1)
			        	else
			        		sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=Cstr(DayDifference(currentDate,endDate)+1)
			        	End If
	             		End If
	             	End If
	        	 End If
	        Else
	        	sheet.getCellrangeByName(&quot;C&quot;&amp;(row+1)&amp;&quot;:C&quot;&amp;(row+1)).string=&quot;&quot;
	        End If
		End If
		protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;B&quot;,&quot;e1DateOfFirstUseW_Listener_&quot;,e1DateOfFirstUseW_Listener,e1DateOfFirstUseW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Cost
&apos;D_Stock_Analysis - Part1
&apos;Case : Wife
&apos;*************************************
sub e1CostW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1CostW_Listener,e1CostW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;D&quot;,&quot;e1CostW_Listener_&quot;,e1CostW_Listener,e1CostW)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;D&quot;&amp;(startRowNum+1)&amp;&quot;:D&quot;&amp;(endRowNum+1))
		Unprotectsheet(&quot;E1_IDA_CA&quot;)
		Dim cost as Double
		Dim investment as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			cost = currRange.value
			row = currRange.getCellAddress().Row 
			investment = sheet.getCellrangeByName(&quot;E&quot; &amp; (row+1) &amp; &quot;:E&quot; &amp; (row+1)).value
			investmentString = sheet.getCellrangeByName(&quot;E&quot; &amp; (row+1) &amp; &quot;:E&quot; &amp; (row+1)).string
			
			If investmentString &lt;&gt; &quot;&quot; then
			If (investment &gt; cost) and currRange.string&lt;&gt;&quot;&quot; then
	   		     currRange.string=&quot;&quot;
	   		     MsgBox &quot;Investment cannot be greater than Cost.&quot;
			End if
			End if
		End If
	End if
	Protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;D&quot;,&quot;e1CostW_Listener_&quot;,e1CostW_Listener,e1CostW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Investment Deduction
&apos;D_Stock_Analysis - Part1
&apos;Case : Wife
&apos;*************************************
sub e1InvestmenntDeducW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1InvestmenntDeducW_Listener,e1InvestmenntDeducW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;D&quot;,&quot;e1InvestmenntDeducW_Listener_&quot;,e1InvestmenntDeducW_Listener,e1Cost)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;D&quot;&amp;(startRowNum+1)&amp;&quot;:D&quot;&amp;(endRowNum+1))
		Unprotectsheet(&quot;E1_IDA_CA&quot;)
		Dim cost as Double
		Dim investment as Double
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			investment = currRange.value
			row = currRange.getCellAddress().Row 
			cost = sheet.getCellrangeByName(&quot;D&quot; &amp; (row+1) &amp; &quot;:D&quot; &amp; (row+1)).value
			costString = sheet.getCellrangeByName(&quot;D&quot; &amp; (row+1) &amp; &quot;:D&quot; &amp; (row+1)).string
			
			If costString &lt;&gt; &quot;&quot; then
			If (investment &gt; cost) and currRange.string&lt;&gt;&quot;&quot; then
	   		     currRange.string=&quot;&quot;
	   		     MsgBox &quot;Investment cannot be greater than Cost.&quot;
			End if
			End if
		End If
	End if
	Protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;E&quot;,&quot;e1InvestmenntDeducW_Listener_&quot;,e1InvestmenntDeducW_Listener,e1InvestmenntDeducW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Capital Allowance
&apos;D_Stock_Analysis - Part2
&apos;Case : Wife
&apos;*************************************
sub p2CapAllW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p2CapAllW_Listener,p2CapAllW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;H&quot;&amp;(startRowNum+1)&amp;&quot;:H&quot;&amp;(endRowNum+1))
		
		Dim qualfAll as Double
		Dim resVal as Double
		Dim capAllVal as Double
		Dim capAllStr as String
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			capAllStr = currRange.String
			capAllVal= currRange.value
			row = currRange.getCellAddress().Row 
			qualfAll = sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp; (row+1)).value
			resVal = sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp; (row+1)).Value
			if capAllStr&lt;&gt;&quot;&quot; then
				if (qualfAll+ resVal) &lt;&gt;0 then
					If ((qualfAll+ resVal)&lt; capAllVal) then
			   		     currRange.string=&quot;&quot;
			   		     MsgBox &quot;Capital Allowance in row &quot; &amp; (row+1)  &amp; &quot; should be less than or equal to sum of values in C and D.&quot;
					End if
				End If
			End If
		End If
	End if
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;H&quot;,&quot;p2CapAllW_Listener_&quot;,p2CapAllW_Listener,p2CapAllW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Residual Value
&apos;D_Stock_Analysis - Part2
&apos;Case : Wife
&apos;*************************************
sub p2ResValW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p2ResValW_Listener,p2ResValW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;IniAllIBD.ListPart2W&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;G&quot;&amp;(startRowNum+1)&amp;&quot;:G&quot;&amp;(endRowNum+1))
		
		Dim qualfAll as Double
		Dim resVal as Double
		Dim capAllVal as Double
		Dim resValStr as String
		Dim msgStr As String
		Dim currRange as Object
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			resValStr = currRange.String
			resVal= currRange.value
			row = currRange.getCellAddress().Row 
			qualfAll = sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp; (row+1)).value
			capAllVal = sheet.getCellrangeByName(&quot;H&quot; &amp; (row+1) &amp; &quot;:H&quot; &amp; (row+1)).Value
			if resValStr&lt;&gt;&quot;&quot; then
				if (qualfAll+ resVal) &lt;&gt;0 then
					If ((qualfAll+ resVal)&lt; capAllVal) then
			   		     currRange.string=&quot;&quot;
			   		     MsgBox &quot;Capital Allowance in row &quot; &amp; (row+1)  &amp; &quot; should be less than or equal to sum of values in C and D.&quot;
					End if
				End If
			End If
		End If
	End if
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2W&quot;,&quot;G&quot;,&quot;p2ResValW_Listener_&quot;,p2ResValW_Listener,p2ResValW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
	
&apos;*************************************
&apos;Check on Date Of Expenditure
&apos;D_Stock_Analysis - Part4
&apos;Case : Wife
&apos;*************************************
sub e1DateOfExpenditureP4W_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1DateOfExpenditureP4W_Listener,e1DateOfExpenditureP4W)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListW&quot;,&quot;B&quot;,&quot;e1DateOfExpenditureP4W_Listener_&quot;,e1DateOfExpenditureP4W_Listener,e1DateOfExpenditureP4W)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
		Dim endDate as String
		Dim startDate as String
		
	    oRange = ThisComponent.NamedRanges.getByName(&quot;AgrLandDed.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;B&quot;&amp;(startRowNum+1)&amp;&quot;:B&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;E1_IDA_CA&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim currentDate As String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			currentDate= currRange.string
			row= currRange.getCellAddress().Row 
	         If currentDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(currentDate) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            ElseIf TestDateBtwnRtnPeriod(currentDate)=False Then
	                           msgStr = msgStr &amp; (row+1)
			        		   currRange.string = &quot;&quot;
			        		   &apos;MsgBox &quot;Date of Expenditure should be before or within return period.&quot;
			        		   MsgBox &quot;Date of Expenditure in Row &quot; &amp; (row+1) &amp; &quot; should be within Return Period &quot; &amp; startDate &amp; &quot; and &quot; &amp; endDate &amp;&quot;.&quot;
	             	End If
	        	 End If
	        End If
		End If
		protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListW&quot;,&quot;B&quot;,&quot;e1DateOfExpenditureP4W_Listener_&quot;,e1DateOfExpenditureP4W_Listener,e1DateOfExpenditureP4W)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub	

&apos;*************************************
&apos;Check on Written Down Value
&apos;D_Stock_Analysis - Part4
&apos;Case : Wife
&apos;*************************************
sub p4WrtnDownValW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p4WrtnDownValW_Listener,p4WrtnDownValW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;AgrLandDed.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;G&quot;&amp;(startRowNum+1)&amp;&quot;:G&quot;&amp;(endRowNum+1))
		
		Dim ACostVal as Double
		Dim BCostVal as Double
		Dim CCostVal As Double
		Dim DCostVal As Double
		Dim msgStr As String
		Dim currRange as Object
		Dim amt as Double
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		
		
			row = currRange.getCellAddress().Row 
			col=currRange.getCellAddress().column
			labelName=sheet.getCellByPosition(col,startRowNum-1).string
		
			ACostVal=  sheet.getCellrangeByName(&quot;C&quot; &amp; (row+1) &amp; &quot;:C&quot; &amp; (row+1)).Value
			BCostVal = sheet.getCellrangeByName(&quot;D&quot; &amp; (row+1) &amp; &quot;:D&quot; &amp; (row+1)).value
			CCostVal = sheet.getCellrangeByName(&quot;E&quot; &amp; (row+1) &amp; &quot;:E&quot; &amp; (row+1)).Value
			DCostVal = sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp; (row+1)).Value
			amt=ACostVal+BCostVal-CCostVal-DCostVal
			if amt&lt;0 then
				currRange.string=&quot;&quot;
				&apos;MsgBox Trim(labelName) &amp; &quot; should be less than or equal to A+B.&quot;
				MsgBox &quot;The sum of values of A and B should be greater than or equal to sum of values of C and D.&quot;
			End if
		
	End if
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;AgrLandDed.ListW&quot;,&quot;G&quot;,&quot;p4WrtnDownValW_Listener_&quot;,p4WrtnDownValW_Listener,p4WrtnDownValW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
	
&apos;*************************************
&apos;Check on Date Of First Use
&apos;D_Stock_Analysis - Part5
&apos;Case : Wife
&apos;*************************************
sub e1DateOfFirstUseP5W_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(e1DateOfFirstUseP5W_Listener,e1DateOfFirstUseP5W)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
		call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListW&quot;,&quot;D&quot;,&quot;e1DateOfFirstUseP5W_Listener_&quot;,e1DateOfFirstUseP5W_Listener,e1DateOfFirstUseP5W)
	    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************	
		Dim endDate as String
		Dim startDate as String
	    oRange = ThisComponent.NamedRanges.getByName(&quot;DeprIntengAst.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;D&quot;&amp;(startRowNum+1)&amp;&quot;:D&quot;&amp;(endRowNum+1))
		unprotectsheet(&quot;E1_IDA_CA&quot;)
		startDate =    ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetStartDate&quot;).string
		endDate =   ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;).getCellrangeByName(&quot;RetInf.RetEndDate&quot;).string
		
		Dim purchaseDate as String
		Dim dateFrom As String
		Dim year as String
		Dim month as String
		Dim day as String
		Dim endDt as Object
		Dim possibleDate as String
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		If Not IsNull(oColRange.queryintersection(currRange.rangeaddress)) and (currRange.supportsService(&quot;com.sun.star.sheet.SheetCell&quot;)) then
			purchaseDate= currRange.string
			row= currRange.getCellAddress().Row 
	         If purchaseDate&lt;&gt;&quot;&quot; then
	            If (ValidateDate(purchaseDate) = False) Then
		             msgStr = msgStr &amp; (row+1)
			         currRange.string = &quot;&quot;
			         MsgBox  msgDateFrmt
	   		    Else
	        	    If (startDate = &quot;&quot;) OR ValidateDate(startDate)=False Or (endDate = &quot;&quot;) Or ValidateDate(endDate)=False Then
			       	     currRange.string = &quot;&quot;
	            		 MsgBox msgEntrPrdDate
	              		 ThisComponent.CurrentController.setActiveSheet(ThisComponent.Sheets.getByName(&quot;A_Basic_Info&quot;))
		            Else
		            	endDt= Split(endDate,&quot;/&quot;)
	              		year=INT(endDt(2))
	              		month=INT(endDt(1))
	              		day=INT(endDt(0))
	              		possibleDate = specificDateBeforeYears(startDate,6)
			            If lessThnEqualToReturnYr(purchaseDate,year,month,day)=False Then
				        		   currRange.string = &quot;&quot;
				        		   msgStr = msgStr &amp; (row+1)
				        		   MsgBox &quot;Date of First Use should be before or within Return Period.&quot;
				        ElseIf TestDateBtwnRtnPeriod(purchaseDate)=True Then
			        		   sheet.getCellrangeByName(&quot;E&quot;&amp;(row+1)&amp;&quot;:E&quot;&amp;(row+1)).value=40
			        		   &apos;MsgBox &quot;Date is between return period.&quot;
			        	ElseIf (checkGrtrThnDate(possibleDate,purchaseDate)) = True Then
	                           sheet.getCellrangeByName(&quot;E&quot;&amp;(row+1)&amp;&quot;:E&quot;&amp;(row+1)).value=10
		        		       &apos;MsgBox &quot;Date is between 6 years before return period to date to return period to date.&quot;
			        	Else
			        		   sheet.getCellrangeByName(&quot;E&quot;&amp;(row+1)&amp;&quot;:E&quot;&amp;(row+1)).value=0
			        		   &apos;MsgBox &quot;Date is not between return period.&quot;
	             		End If
	             	End If
	         	End If
	         Else
	         	sheet.getCellrangeByName(&quot;E&quot;&amp;(row+1)&amp;&quot;:E&quot;&amp;(row+1)).string=&quot;&quot;
	         End If
		End If
		protectsheet(&quot;E1_IDA_CA&quot;)
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListW&quot;,&quot;D&quot;,&quot;e1DateOfFirstUseP5W_Listener_&quot;,e1DateOfFirstUseP5W_Listener,e1DateOfFirstUseP5W)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub

&apos;*************************************
&apos;Check on Total Cost
&apos;D_Stock_Analysis - Part5
&apos;Case : Wife
&apos;*************************************
sub p5TotCostW_Listener_modified(oEv)
	if (notCallListener) then  
		exit Sub  
	end if &apos; Added By KANDARP 
	thisComponent.CurrentController.Frame.ContainerWindow.Enable= False
	call removeKRAListners(p5TotCostW_Listener,p5TotCostW)
	
	&apos;code
		
	oSheet = ThisComponent.CurrentController.getActiveSheet() 
	&apos;*******************************
	&apos;Code Added to restrict Listeners to be called while Amendment
	if  oSheet.name = &quot;Amendment&quot; then
	&apos;	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;IniAllIBD.ListPart2&quot;,&quot;D&quot;,&quot;e1Cost_Listener_&quot;,e1Cost_Listener,e1Cost)
	 &apos;   thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
		Exit sub
	End If
	&apos;*******************************
	
	if(oSheet.name&lt;&gt;&quot;A_Basic_Info&quot;) then
		Dim startRowNum as Long , endRowNum as Long, startColumnNum as Long , endcolumnNum as Long
	    oRange = ThisComponent.NamedRanges.getByName(&quot;DeprIntengAst.ListW&quot;)
	    startRowNum = oRange.getReferredCells().getRangeAddress().StartRow
	    endRowNum = oRange.getReferredCells().getRangeAddress().EndRow
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
		oColRange = sheet.getCellrangeByName(&quot;H&quot;&amp;(startRowNum+1)&amp;&quot;:H&quot;&amp;(endRowNum+1))
		
		Dim BCostVal as Double
		Dim CCostVal as Double
	
		Dim msgStr As String
		Dim currRange as Object
		Dim amt as Double
		Dim row As Long
		
		sheet=ThisComponent.sheets.getByName(&quot;E1_IDA_CA&quot;)
	&apos;***
		currRange = ThisComponent.getCurrentSelection() 
		
		
			row = currRange.getCellAddress().Row 
			col=currRange.getCellAddress().column
			
			BCostVal=  sheet.getCellrangeByName(&quot;F&quot; &amp; (row+1) &amp; &quot;:F&quot; &amp; (row+1)).Value
			CCostVal = sheet.getCellrangeByName(&quot;G&quot; &amp; (row+1) &amp; &quot;:G&quot; &amp; (row+1)).value
		
			amt=BCostVal-CCostVal
			if amt&lt;0 then
				currRange.string=&quot;&quot;
			   	if col=6 then
			   		MsgBox &quot;Disposal at Cost during the Year should be less than or equal to Actual Cost.&quot;
			   	else
				   MsgBox &quot;Actual Cost should be greater than or equal to Disposal at Cost during the Year.&quot;
			   	End If
			   	
			End if
		
	End if
	
	&apos;code
	
	call addKRAListnersMultiCell(&quot;E1_IDA_CA&quot;,&quot;DeprIntengAst.ListW&quot;,&quot;H&quot;,&quot;p5TotCostW_Listener_&quot;,p5TotCostW_Listener,p5TotCostW)
    thisComponent.CurrentController.Frame.ContainerWindow.Enable= True
end sub
</script:module>